<!doctype html>
<html class="no-js" lang="en" data-content_root="./">
  <head><meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="genindex.html"><link rel="search" title="Search" href="search.html">
        <link rel="prefetch" href="_static/img/logo-light.svg" as="image">
        <link rel="prefetch" href="_static/img/logo-dark.svg" as="image">

    <link rel="shortcut icon" href="_static/favicon.ico"><!-- Generated with Sphinx 8.2.3 and Furo 2025.09.25 -->
        <title>stable_worldmodel package - stable-worldmodel Documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=580074bf" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=8dab3a3b" />
    <link rel="stylesheet" type="text/css" href="_static/css/custom.css?v=33d9fa98" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/fontawesome.min.css" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/solid.min.css" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/brands.min.css" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  --color-brand-primary: #202123;
  --color-brand-content: #296cde;
  --color-inline-code-background: #f8f8f8;
  --color-brand-visited: #2757dd;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle site navigation sidebar">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc" aria-label="Toggle table of contents sidebar">
<label class="overlay sidebar-overlay" for="__navigation"></label>
<label class="overlay toc-overlay" for="__toc"></label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <span class="icon"><svg><use href="#svg-menu"></use></svg></span>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">stable-worldmodel
Documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="_static/img/logo-light.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="_static/img/logo-dark.svg" alt="Dark Logo"/>
  </div>
  
  <span class="sidebar-brand-text">stable-worldmodel
Documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/randall-lab/stable-worldmodel">Github</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/randall-lab/stable-worldmodel/tree/main/docs">Contribute to the Docs</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="edit-this-page">
  <a class="muted-link" href="https://github.com/randall-lab/stable-worldmodel/edit/main/docs/stable_worldmodel.rst" rel="edit" title="Edit this page">
    <svg><use href="#svg-pencil"></use></svg>
    <span class="visually-hidden">Edit this page</span>
  </a>
</div><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="stable-worldmodel-package">
<h1>stable_worldmodel package<a class="headerlink" href="#stable-worldmodel-package" title="Link to this heading">¶</a></h1>
<section id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Link to this heading">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="stable_worldmodel.envs.html">stable_worldmodel.envs package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="stable_worldmodel.envs.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="stable_worldmodel.envs.html#module-stable_worldmodel.envs.image_positioning">stable_worldmodel.envs.image_positioning module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="stable_worldmodel.envs.html#stable_worldmodel.envs.image_positioning.ImagePositioning"><code class="docutils literal notranslate"><span class="pre">ImagePositioning</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.envs.html#stable_worldmodel.envs.image_positioning.ImagePositioning.close"><code class="docutils literal notranslate"><span class="pre">ImagePositioning.close()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.envs.html#stable_worldmodel.envs.image_positioning.ImagePositioning.metadata"><code class="docutils literal notranslate"><span class="pre">ImagePositioning.metadata</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.envs.html#stable_worldmodel.envs.image_positioning.ImagePositioning.render"><code class="docutils literal notranslate"><span class="pre">ImagePositioning.render()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.envs.html#stable_worldmodel.envs.image_positioning.ImagePositioning.reset"><code class="docutils literal notranslate"><span class="pre">ImagePositioning.reset()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.envs.html#stable_worldmodel.envs.image_positioning.ImagePositioning.step"><code class="docutils literal notranslate"><span class="pre">ImagePositioning.step()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="stable_worldmodel.envs.html#module-stable_worldmodel.envs.pusht">stable_worldmodel.envs.pusht module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="stable_worldmodel.envs.html#stable_worldmodel.envs.pusht.PushT"><code class="docutils literal notranslate"><span class="pre">PushT</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.envs.html#stable_worldmodel.envs.pusht.PushT.add_I"><code class="docutils literal notranslate"><span class="pre">PushT.add_I()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.envs.html#stable_worldmodel.envs.pusht.PushT.add_L"><code class="docutils literal notranslate"><span class="pre">PushT.add_L()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.envs.html#stable_worldmodel.envs.pusht.PushT.add_Z"><code class="docutils literal notranslate"><span class="pre">PushT.add_Z()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.envs.html#stable_worldmodel.envs.pusht.PushT.add_box"><code class="docutils literal notranslate"><span class="pre">PushT.add_box()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.envs.html#stable_worldmodel.envs.pusht.PushT.add_circle"><code class="docutils literal notranslate"><span class="pre">PushT.add_circle()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.envs.html#stable_worldmodel.envs.pusht.PushT.add_plus"><code class="docutils literal notranslate"><span class="pre">PushT.add_plus()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.envs.html#stable_worldmodel.envs.pusht.PushT.add_shape"><code class="docutils literal notranslate"><span class="pre">PushT.add_shape()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.envs.html#stable_worldmodel.envs.pusht.PushT.add_small_tee"><code class="docutils literal notranslate"><span class="pre">PushT.add_small_tee()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.envs.html#stable_worldmodel.envs.pusht.PushT.add_square"><code class="docutils literal notranslate"><span class="pre">PushT.add_square()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.envs.html#stable_worldmodel.envs.pusht.PushT.add_tee"><code class="docutils literal notranslate"><span class="pre">PushT.add_tee()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.envs.html#stable_worldmodel.envs.pusht.PushT.close"><code class="docutils literal notranslate"><span class="pre">PushT.close()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.envs.html#stable_worldmodel.envs.pusht.PushT.eval_state"><code class="docutils literal notranslate"><span class="pre">PushT.eval_state()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.envs.html#stable_worldmodel.envs.pusht.PushT.metadata"><code class="docutils literal notranslate"><span class="pre">PushT.metadata</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.envs.html#stable_worldmodel.envs.pusht.PushT.render"><code class="docutils literal notranslate"><span class="pre">PushT.render()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.envs.html#stable_worldmodel.envs.pusht.PushT.reset"><code class="docutils literal notranslate"><span class="pre">PushT.reset()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.envs.html#stable_worldmodel.envs.pusht.PushT.reward_range"><code class="docutils literal notranslate"><span class="pre">PushT.reward_range</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.envs.html#stable_worldmodel.envs.pusht.PushT.step"><code class="docutils literal notranslate"><span class="pre">PushT.step()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="stable_worldmodel.envs.html#module-stable_worldmodel.envs.simple_point_maze">stable_worldmodel.envs.simple_point_maze module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="stable_worldmodel.envs.html#stable_worldmodel.envs.simple_point_maze.SimplePointMazeEnv"><code class="docutils literal notranslate"><span class="pre">SimplePointMazeEnv</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.envs.html#stable_worldmodel.envs.simple_point_maze.SimplePointMazeEnv.close"><code class="docutils literal notranslate"><span class="pre">SimplePointMazeEnv.close()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.envs.html#stable_worldmodel.envs.simple_point_maze.SimplePointMazeEnv.metadata"><code class="docutils literal notranslate"><span class="pre">SimplePointMazeEnv.metadata</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.envs.html#stable_worldmodel.envs.simple_point_maze.SimplePointMazeEnv.render"><code class="docutils literal notranslate"><span class="pre">SimplePointMazeEnv.render()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.envs.html#stable_worldmodel.envs.simple_point_maze.SimplePointMazeEnv.reset"><code class="docutils literal notranslate"><span class="pre">SimplePointMazeEnv.reset()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.envs.html#stable_worldmodel.envs.simple_point_maze.SimplePointMazeEnv.step"><code class="docutils literal notranslate"><span class="pre">SimplePointMazeEnv.step()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="stable_worldmodel.envs.html#module-stable_worldmodel.envs.two_room">stable_worldmodel.envs.two_room module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="stable_worldmodel.envs.html#stable_worldmodel.envs.two_room.TwoRoomEnv"><code class="docutils literal notranslate"><span class="pre">TwoRoomEnv</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.envs.html#stable_worldmodel.envs.two_room.TwoRoomEnv.add_circle"><code class="docutils literal notranslate"><span class="pre">TwoRoomEnv.add_circle()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.envs.html#stable_worldmodel.envs.two_room.TwoRoomEnv.check_collide"><code class="docutils literal notranslate"><span class="pre">TwoRoomEnv.check_collide()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.envs.html#stable_worldmodel.envs.two_room.TwoRoomEnv.check_one_door_fit"><code class="docutils literal notranslate"><span class="pre">TwoRoomEnv.check_one_door_fit()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.envs.html#stable_worldmodel.envs.two_room.TwoRoomEnv.check_other_room"><code class="docutils literal notranslate"><span class="pre">TwoRoomEnv.check_other_room()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.envs.html#stable_worldmodel.envs.two_room.TwoRoomEnv.close"><code class="docutils literal notranslate"><span class="pre">TwoRoomEnv.close()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.envs.html#stable_worldmodel.envs.two_room.TwoRoomEnv.metadata"><code class="docutils literal notranslate"><span class="pre">TwoRoomEnv.metadata</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.envs.html#stable_worldmodel.envs.two_room.TwoRoomEnv.render"><code class="docutils literal notranslate"><span class="pre">TwoRoomEnv.render()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.envs.html#stable_worldmodel.envs.two_room.TwoRoomEnv.reset"><code class="docutils literal notranslate"><span class="pre">TwoRoomEnv.reset()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.envs.html#stable_worldmodel.envs.two_room.TwoRoomEnv.seed"><code class="docutils literal notranslate"><span class="pre">TwoRoomEnv.seed()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.envs.html#stable_worldmodel.envs.two_room.TwoRoomEnv.step"><code class="docutils literal notranslate"><span class="pre">TwoRoomEnv.step()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="stable_worldmodel.envs.html#module-stable_worldmodel.envs.utils">stable_worldmodel.envs.utils module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="stable_worldmodel.envs.html#stable_worldmodel.envs.utils.DrawOptions"><code class="docutils literal notranslate"><span class="pre">DrawOptions</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.envs.html#stable_worldmodel.envs.utils.DrawOptions.__init__"><code class="docutils literal notranslate"><span class="pre">DrawOptions.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.envs.html#stable_worldmodel.envs.utils.DrawOptions.draw_circle"><code class="docutils literal notranslate"><span class="pre">DrawOptions.draw_circle()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.envs.html#stable_worldmodel.envs.utils.DrawOptions.draw_dot"><code class="docutils literal notranslate"><span class="pre">DrawOptions.draw_dot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.envs.html#stable_worldmodel.envs.utils.DrawOptions.draw_fat_segment"><code class="docutils literal notranslate"><span class="pre">DrawOptions.draw_fat_segment()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.envs.html#stable_worldmodel.envs.utils.DrawOptions.draw_polygon"><code class="docutils literal notranslate"><span class="pre">DrawOptions.draw_polygon()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.envs.html#stable_worldmodel.envs.utils.DrawOptions.draw_segment"><code class="docutils literal notranslate"><span class="pre">DrawOptions.draw_segment()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="stable_worldmodel.envs.html#stable_worldmodel.envs.utils.from_pygame"><code class="docutils literal notranslate"><span class="pre">from_pygame()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="stable_worldmodel.envs.html#stable_worldmodel.envs.utils.get_mouse_pos"><code class="docutils literal notranslate"><span class="pre">get_mouse_pos()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="stable_worldmodel.envs.html#stable_worldmodel.envs.utils.light_color"><code class="docutils literal notranslate"><span class="pre">light_color()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="stable_worldmodel.envs.html#stable_worldmodel.envs.utils.pymunk_to_shapely"><code class="docutils literal notranslate"><span class="pre">pymunk_to_shapely()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="stable_worldmodel.envs.html#stable_worldmodel.envs.utils.to_pygame"><code class="docutils literal notranslate"><span class="pre">to_pygame()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="stable_worldmodel.envs.html#module-stable_worldmodel.envs.voidrun">stable_worldmodel.envs.voidrun module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="stable_worldmodel.envs.html#stable_worldmodel.envs.voidrun.Action"><code class="docutils literal notranslate"><span class="pre">Action</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.envs.html#stable_worldmodel.envs.voidrun.Action.DOWN"><code class="docutils literal notranslate"><span class="pre">Action.DOWN</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.envs.html#stable_worldmodel.envs.voidrun.Action.LEFT"><code class="docutils literal notranslate"><span class="pre">Action.LEFT</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.envs.html#stable_worldmodel.envs.voidrun.Action.RIGHT"><code class="docutils literal notranslate"><span class="pre">Action.RIGHT</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.envs.html#stable_worldmodel.envs.voidrun.Action.UP"><code class="docutils literal notranslate"><span class="pre">Action.UP</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="stable_worldmodel.envs.html#stable_worldmodel.envs.voidrun.VoidRunEnv"><code class="docutils literal notranslate"><span class="pre">VoidRunEnv</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.envs.html#stable_worldmodel.envs.voidrun.VoidRunEnv.check_location"><code class="docutils literal notranslate"><span class="pre">VoidRunEnv.check_location()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.envs.html#stable_worldmodel.envs.voidrun.VoidRunEnv.check_termination"><code class="docutils literal notranslate"><span class="pre">VoidRunEnv.check_termination()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.envs.html#stable_worldmodel.envs.voidrun.VoidRunEnv.close"><code class="docutils literal notranslate"><span class="pre">VoidRunEnv.close()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.envs.html#stable_worldmodel.envs.voidrun.VoidRunEnv.generate_board"><code class="docutils literal notranslate"><span class="pre">VoidRunEnv.generate_board()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.envs.html#stable_worldmodel.envs.voidrun.VoidRunEnv.generate_goal"><code class="docutils literal notranslate"><span class="pre">VoidRunEnv.generate_goal()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.envs.html#stable_worldmodel.envs.voidrun.VoidRunEnv.metadata"><code class="docutils literal notranslate"><span class="pre">VoidRunEnv.metadata</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.envs.html#stable_worldmodel.envs.voidrun.VoidRunEnv.render"><code class="docutils literal notranslate"><span class="pre">VoidRunEnv.render()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.envs.html#stable_worldmodel.envs.voidrun.VoidRunEnv.render_board"><code class="docutils literal notranslate"><span class="pre">VoidRunEnv.render_board()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.envs.html#stable_worldmodel.envs.voidrun.VoidRunEnv.reset"><code class="docutils literal notranslate"><span class="pre">VoidRunEnv.reset()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.envs.html#stable_worldmodel.envs.voidrun.VoidRunEnv.set_state"><code class="docutils literal notranslate"><span class="pre">VoidRunEnv.set_state()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.envs.html#stable_worldmodel.envs.voidrun.VoidRunEnv.step"><code class="docutils literal notranslate"><span class="pre">VoidRunEnv.step()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="stable_worldmodel.envs.html#module-stable_worldmodel.envs">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="stable_worldmodel.solver.html">stable_worldmodel.solver package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="stable_worldmodel.solver.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="stable_worldmodel.solver.html#module-stable_worldmodel.solver.cem">stable_worldmodel.solver.cem module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="stable_worldmodel.solver.html#stable_worldmodel.solver.cem.CEMSolver"><code class="docutils literal notranslate"><span class="pre">CEMSolver</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.solver.html#stable_worldmodel.solver.cem.CEMSolver.action_dim"><code class="docutils literal notranslate"><span class="pre">CEMSolver.action_dim</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.solver.html#stable_worldmodel.solver.cem.CEMSolver.configure"><code class="docutils literal notranslate"><span class="pre">CEMSolver.configure()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.solver.html#stable_worldmodel.solver.cem.CEMSolver.horizon"><code class="docutils literal notranslate"><span class="pre">CEMSolver.horizon</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.solver.html#stable_worldmodel.solver.cem.CEMSolver.init_action_distrib"><code class="docutils literal notranslate"><span class="pre">CEMSolver.init_action_distrib()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.solver.html#stable_worldmodel.solver.cem.CEMSolver.n_envs"><code class="docutils literal notranslate"><span class="pre">CEMSolver.n_envs</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.solver.html#stable_worldmodel.solver.cem.CEMSolver.solve"><code class="docutils literal notranslate"><span class="pre">CEMSolver.solve()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="stable_worldmodel.solver.html#module-stable_worldmodel.solver.gd">stable_worldmodel.solver.gd module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="stable_worldmodel.solver.html#stable_worldmodel.solver.gd.GDSolver"><code class="docutils literal notranslate"><span class="pre">GDSolver</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.solver.html#stable_worldmodel.solver.gd.GDSolver.action_dim"><code class="docutils literal notranslate"><span class="pre">GDSolver.action_dim</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.solver.html#stable_worldmodel.solver.gd.GDSolver.configure"><code class="docutils literal notranslate"><span class="pre">GDSolver.configure()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.solver.html#stable_worldmodel.solver.gd.GDSolver.horizon"><code class="docutils literal notranslate"><span class="pre">GDSolver.horizon</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.solver.html#stable_worldmodel.solver.gd.GDSolver.init_action"><code class="docutils literal notranslate"><span class="pre">GDSolver.init_action()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.solver.html#stable_worldmodel.solver.gd.GDSolver.n_envs"><code class="docutils literal notranslate"><span class="pre">GDSolver.n_envs</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.solver.html#stable_worldmodel.solver.gd.GDSolver.solve"><code class="docutils literal notranslate"><span class="pre">GDSolver.solve()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="stable_worldmodel.solver.html#stable-worldmodel-solver-mppi-module">stable_worldmodel.solver.mppi module</a></li>
<li class="toctree-l2"><a class="reference internal" href="stable_worldmodel.solver.html#module-stable_worldmodel.solver.random">stable_worldmodel.solver.random module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="stable_worldmodel.solver.html#stable_worldmodel.solver.random.RandomSolver"><code class="docutils literal notranslate"><span class="pre">RandomSolver</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.solver.html#stable_worldmodel.solver.random.RandomSolver.__init__"><code class="docutils literal notranslate"><span class="pre">RandomSolver.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.solver.html#stable_worldmodel.solver.random.RandomSolver.action_dim"><code class="docutils literal notranslate"><span class="pre">RandomSolver.action_dim</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.solver.html#stable_worldmodel.solver.random.RandomSolver.configure"><code class="docutils literal notranslate"><span class="pre">RandomSolver.configure()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.solver.html#stable_worldmodel.solver.random.RandomSolver.horizon"><code class="docutils literal notranslate"><span class="pre">RandomSolver.horizon</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.solver.html#stable_worldmodel.solver.random.RandomSolver.n_envs"><code class="docutils literal notranslate"><span class="pre">RandomSolver.n_envs</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.solver.html#stable_worldmodel.solver.random.RandomSolver.solve"><code class="docutils literal notranslate"><span class="pre">RandomSolver.solve()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="stable_worldmodel.solver.html#module-stable_worldmodel.solver.solver">stable_worldmodel.solver.solver module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="stable_worldmodel.solver.html#stable_worldmodel.solver.solver.Costable"><code class="docutils literal notranslate"><span class="pre">Costable</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.solver.html#stable_worldmodel.solver.solver.Costable.get_cost"><code class="docutils literal notranslate"><span class="pre">Costable.get_cost()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="stable_worldmodel.solver.html#stable_worldmodel.solver.solver.Solver"><code class="docutils literal notranslate"><span class="pre">Solver</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.solver.html#stable_worldmodel.solver.solver.Solver.action_dim"><code class="docutils literal notranslate"><span class="pre">Solver.action_dim</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.solver.html#stable_worldmodel.solver.solver.Solver.configure"><code class="docutils literal notranslate"><span class="pre">Solver.configure()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.solver.html#stable_worldmodel.solver.solver.Solver.horizon"><code class="docutils literal notranslate"><span class="pre">Solver.horizon</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.solver.html#stable_worldmodel.solver.solver.Solver.n_envs"><code class="docutils literal notranslate"><span class="pre">Solver.n_envs</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.solver.html#stable_worldmodel.solver.solver.Solver.solve"><code class="docutils literal notranslate"><span class="pre">Solver.solve()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="stable_worldmodel.solver.html#module-stable_worldmodel.solver">Module contents</a><ul>
<li class="toctree-l3"><a class="reference internal" href="stable_worldmodel.solver.html#stable_worldmodel.solver.CEMSolver"><code class="docutils literal notranslate"><span class="pre">CEMSolver</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.solver.html#stable_worldmodel.solver.CEMSolver.action_dim"><code class="docutils literal notranslate"><span class="pre">CEMSolver.action_dim</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.solver.html#stable_worldmodel.solver.CEMSolver.configure"><code class="docutils literal notranslate"><span class="pre">CEMSolver.configure()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.solver.html#stable_worldmodel.solver.CEMSolver.horizon"><code class="docutils literal notranslate"><span class="pre">CEMSolver.horizon</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.solver.html#stable_worldmodel.solver.CEMSolver.init_action_distrib"><code class="docutils literal notranslate"><span class="pre">CEMSolver.init_action_distrib()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.solver.html#stable_worldmodel.solver.CEMSolver.n_envs"><code class="docutils literal notranslate"><span class="pre">CEMSolver.n_envs</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.solver.html#stable_worldmodel.solver.CEMSolver.solve"><code class="docutils literal notranslate"><span class="pre">CEMSolver.solve()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="stable_worldmodel.solver.html#stable_worldmodel.solver.GDSolver"><code class="docutils literal notranslate"><span class="pre">GDSolver</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.solver.html#stable_worldmodel.solver.GDSolver.action_dim"><code class="docutils literal notranslate"><span class="pre">GDSolver.action_dim</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.solver.html#stable_worldmodel.solver.GDSolver.configure"><code class="docutils literal notranslate"><span class="pre">GDSolver.configure()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.solver.html#stable_worldmodel.solver.GDSolver.horizon"><code class="docutils literal notranslate"><span class="pre">GDSolver.horizon</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.solver.html#stable_worldmodel.solver.GDSolver.init_action"><code class="docutils literal notranslate"><span class="pre">GDSolver.init_action()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.solver.html#stable_worldmodel.solver.GDSolver.n_envs"><code class="docutils literal notranslate"><span class="pre">GDSolver.n_envs</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.solver.html#stable_worldmodel.solver.GDSolver.solve"><code class="docutils literal notranslate"><span class="pre">GDSolver.solve()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="stable_worldmodel.solver.html#stable_worldmodel.solver.RandomSolver"><code class="docutils literal notranslate"><span class="pre">RandomSolver</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.solver.html#stable_worldmodel.solver.RandomSolver.__init__"><code class="docutils literal notranslate"><span class="pre">RandomSolver.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.solver.html#stable_worldmodel.solver.RandomSolver.action_dim"><code class="docutils literal notranslate"><span class="pre">RandomSolver.action_dim</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.solver.html#stable_worldmodel.solver.RandomSolver.configure"><code class="docutils literal notranslate"><span class="pre">RandomSolver.configure()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.solver.html#stable_worldmodel.solver.RandomSolver.horizon"><code class="docutils literal notranslate"><span class="pre">RandomSolver.horizon</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.solver.html#stable_worldmodel.solver.RandomSolver.n_envs"><code class="docutils literal notranslate"><span class="pre">RandomSolver.n_envs</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.solver.html#stable_worldmodel.solver.RandomSolver.solve"><code class="docutils literal notranslate"><span class="pre">RandomSolver.solve()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="stable_worldmodel.solver.html#stable_worldmodel.solver.Solver"><code class="docutils literal notranslate"><span class="pre">Solver</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.solver.html#stable_worldmodel.solver.Solver.action_dim"><code class="docutils literal notranslate"><span class="pre">Solver.action_dim</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.solver.html#stable_worldmodel.solver.Solver.configure"><code class="docutils literal notranslate"><span class="pre">Solver.configure()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.solver.html#stable_worldmodel.solver.Solver.horizon"><code class="docutils literal notranslate"><span class="pre">Solver.horizon</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.solver.html#stable_worldmodel.solver.Solver.n_envs"><code class="docutils literal notranslate"><span class="pre">Solver.n_envs</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.solver.html#stable_worldmodel.solver.Solver.solve"><code class="docutils literal notranslate"><span class="pre">Solver.solve()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="stable_worldmodel.wm.html">stable_worldmodel.wm package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="stable_worldmodel.wm.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="stable_worldmodel.wm.html#module-stable_worldmodel.wm.dinowm">stable_worldmodel.wm.dinowm module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.dinowm.Attention"><code class="docutils literal notranslate"><span class="pre">Attention</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.dinowm.Attention.forward"><code class="docutils literal notranslate"><span class="pre">Attention.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.dinowm.Attention.generate_mask_matrix"><code class="docutils literal notranslate"><span class="pre">Attention.generate_mask_matrix()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.dinowm.CausalPredictor"><code class="docutils literal notranslate"><span class="pre">CausalPredictor</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.dinowm.CausalPredictor.forward"><code class="docutils literal notranslate"><span class="pre">CausalPredictor.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.dinowm.DINOWM"><code class="docutils literal notranslate"><span class="pre">DINOWM</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.dinowm.DINOWM.decode"><code class="docutils literal notranslate"><span class="pre">DINOWM.decode()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.dinowm.DINOWM.encode"><code class="docutils literal notranslate"><span class="pre">DINOWM.encode()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.dinowm.DINOWM.get_cost"><code class="docutils literal notranslate"><span class="pre">DINOWM.get_cost()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.dinowm.DINOWM.predict"><code class="docutils literal notranslate"><span class="pre">DINOWM.predict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.dinowm.DINOWM.replace_action_in_embedding"><code class="docutils literal notranslate"><span class="pre">DINOWM.replace_action_in_embedding()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.dinowm.DINOWM.rollout"><code class="docutils literal notranslate"><span class="pre">DINOWM.rollout()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.dinowm.DINOWM.split_embedding"><code class="docutils literal notranslate"><span class="pre">DINOWM.split_embedding()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.dinowm.Decoder"><code class="docutils literal notranslate"><span class="pre">Decoder</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.dinowm.Decoder.forward"><code class="docutils literal notranslate"><span class="pre">Decoder.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.dinowm.Embedder"><code class="docutils literal notranslate"><span class="pre">Embedder</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.dinowm.Embedder.forward"><code class="docutils literal notranslate"><span class="pre">Embedder.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.dinowm.Encoder"><code class="docutils literal notranslate"><span class="pre">Encoder</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.dinowm.Encoder.forward"><code class="docutils literal notranslate"><span class="pre">Encoder.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.dinowm.FeedForward"><code class="docutils literal notranslate"><span class="pre">FeedForward</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.dinowm.FeedForward.forward"><code class="docutils literal notranslate"><span class="pre">FeedForward.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.dinowm.Quantize"><code class="docutils literal notranslate"><span class="pre">Quantize</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.dinowm.Quantize.embed_code"><code class="docutils literal notranslate"><span class="pre">Quantize.embed_code()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.dinowm.Quantize.forward"><code class="docutils literal notranslate"><span class="pre">Quantize.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.dinowm.ResBlock"><code class="docutils literal notranslate"><span class="pre">ResBlock</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.dinowm.ResBlock.forward"><code class="docutils literal notranslate"><span class="pre">ResBlock.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.dinowm.Transformer"><code class="docutils literal notranslate"><span class="pre">Transformer</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.dinowm.Transformer.forward"><code class="docutils literal notranslate"><span class="pre">Transformer.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.dinowm.VQVAE"><code class="docutils literal notranslate"><span class="pre">VQVAE</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.dinowm.VQVAE.decode"><code class="docutils literal notranslate"><span class="pre">VQVAE.decode()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.dinowm.VQVAE.decode_code"><code class="docutils literal notranslate"><span class="pre">VQVAE.decode_code()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.dinowm.VQVAE.forward"><code class="docutils literal notranslate"><span class="pre">VQVAE.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.dinowm.all_reduce"><code class="docutils literal notranslate"><span class="pre">all_reduce()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.dinowm.get_world_size"><code class="docutils literal notranslate"><span class="pre">get_world_size()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.dinowm.transform"><code class="docutils literal notranslate"><span class="pre">transform()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="stable_worldmodel.wm.html#module-stable_worldmodel.wm.dreamer">stable_worldmodel.wm.dreamer module</a></li>
<li class="toctree-l2"><a class="reference internal" href="stable_worldmodel.wm.html#module-stable_worldmodel.wm.dummy">stable_worldmodel.wm.dummy module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.dummy.DummyWorldModel"><code class="docutils literal notranslate"><span class="pre">DummyWorldModel</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.dummy.DummyWorldModel.encode"><code class="docutils literal notranslate"><span class="pre">DummyWorldModel.encode()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.dummy.DummyWorldModel.get_cost"><code class="docutils literal notranslate"><span class="pre">DummyWorldModel.get_cost()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.dummy.DummyWorldModel.predict"><code class="docutils literal notranslate"><span class="pre">DummyWorldModel.predict()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.dummy.transform"><code class="docutils literal notranslate"><span class="pre">transform()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="stable_worldmodel.wm.html#module-stable_worldmodel.wm.frame">stable_worldmodel.wm.frame module</a></li>
<li class="toctree-l2"><a class="reference internal" href="stable_worldmodel.wm.html#module-stable_worldmodel.wm.old_dinowm">stable_worldmodel.wm.old_dinowm module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.old_dinowm.Attention"><code class="docutils literal notranslate"><span class="pre">Attention</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.old_dinowm.Attention.forward"><code class="docutils literal notranslate"><span class="pre">Attention.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.old_dinowm.Attention.generate_mask_matrix"><code class="docutils literal notranslate"><span class="pre">Attention.generate_mask_matrix()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.old_dinowm.CausalPredictor"><code class="docutils literal notranslate"><span class="pre">CausalPredictor</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.old_dinowm.CausalPredictor.forward"><code class="docutils literal notranslate"><span class="pre">CausalPredictor.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.old_dinowm.DINOWM"><code class="docutils literal notranslate"><span class="pre">DINOWM</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.old_dinowm.DINOWM.decode_obs"><code class="docutils literal notranslate"><span class="pre">DINOWM.decode_obs()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.old_dinowm.DINOWM.denormalize_actions"><code class="docutils literal notranslate"><span class="pre">DINOWM.denormalize_actions()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.old_dinowm.DINOWM.denormalize_proprio"><code class="docutils literal notranslate"><span class="pre">DINOWM.denormalize_proprio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.old_dinowm.DINOWM.encode"><code class="docutils literal notranslate"><span class="pre">DINOWM.encode()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.old_dinowm.DINOWM.encode_action"><code class="docutils literal notranslate"><span class="pre">DINOWM.encode_action()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.old_dinowm.DINOWM.encode_obs"><code class="docutils literal notranslate"><span class="pre">DINOWM.encode_obs()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.old_dinowm.DINOWM.encode_proprio"><code class="docutils literal notranslate"><span class="pre">DINOWM.encode_proprio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.old_dinowm.DINOWM.forward"><code class="docutils literal notranslate"><span class="pre">DINOWM.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.old_dinowm.DINOWM.normalize_actions"><code class="docutils literal notranslate"><span class="pre">DINOWM.normalize_actions()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.old_dinowm.DINOWM.normalize_proprio"><code class="docutils literal notranslate"><span class="pre">DINOWM.normalize_proprio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.old_dinowm.DINOWM.predict"><code class="docutils literal notranslate"><span class="pre">DINOWM.predict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.old_dinowm.DINOWM.replace_actions_from_z"><code class="docutils literal notranslate"><span class="pre">DINOWM.replace_actions_from_z()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.old_dinowm.DINOWM.rollout"><code class="docutils literal notranslate"><span class="pre">DINOWM.rollout()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.old_dinowm.DINOWM.split_embeddings"><code class="docutils literal notranslate"><span class="pre">DINOWM.split_embeddings()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.old_dinowm.Decoder"><code class="docutils literal notranslate"><span class="pre">Decoder</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.old_dinowm.Decoder.forward"><code class="docutils literal notranslate"><span class="pre">Decoder.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.old_dinowm.DinoV2Encoder"><code class="docutils literal notranslate"><span class="pre">DinoV2Encoder</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.old_dinowm.DinoV2Encoder.forward"><code class="docutils literal notranslate"><span class="pre">DinoV2Encoder.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.old_dinowm.Embedder"><code class="docutils literal notranslate"><span class="pre">Embedder</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.old_dinowm.Embedder.forward"><code class="docutils literal notranslate"><span class="pre">Embedder.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.old_dinowm.Encoder"><code class="docutils literal notranslate"><span class="pre">Encoder</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.old_dinowm.Encoder.forward"><code class="docutils literal notranslate"><span class="pre">Encoder.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.old_dinowm.FeedForward"><code class="docutils literal notranslate"><span class="pre">FeedForward</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.old_dinowm.FeedForward.forward"><code class="docutils literal notranslate"><span class="pre">FeedForward.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.old_dinowm.Quantize"><code class="docutils literal notranslate"><span class="pre">Quantize</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.old_dinowm.Quantize.embed_code"><code class="docutils literal notranslate"><span class="pre">Quantize.embed_code()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.old_dinowm.Quantize.forward"><code class="docutils literal notranslate"><span class="pre">Quantize.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.old_dinowm.ResBlock"><code class="docutils literal notranslate"><span class="pre">ResBlock</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.old_dinowm.ResBlock.forward"><code class="docutils literal notranslate"><span class="pre">ResBlock.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.old_dinowm.Transformer"><code class="docutils literal notranslate"><span class="pre">Transformer</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.old_dinowm.Transformer.forward"><code class="docutils literal notranslate"><span class="pre">Transformer.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.old_dinowm.VQVAE"><code class="docutils literal notranslate"><span class="pre">VQVAE</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.old_dinowm.VQVAE.decode"><code class="docutils literal notranslate"><span class="pre">VQVAE.decode()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.old_dinowm.VQVAE.decode_code"><code class="docutils literal notranslate"><span class="pre">VQVAE.decode_code()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.old_dinowm.VQVAE.forward"><code class="docutils literal notranslate"><span class="pre">VQVAE.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.old_dinowm.all_reduce"><code class="docutils literal notranslate"><span class="pre">all_reduce()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.old_dinowm.get_world_size"><code class="docutils literal notranslate"><span class="pre">get_world_size()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="stable_worldmodel.wm.html#module-stable_worldmodel.wm.tdmpc">stable_worldmodel.wm.tdmpc module</a></li>
<li class="toctree-l2"><a class="reference internal" href="stable_worldmodel.wm.html#module-stable_worldmodel.wm">Module contents</a><ul>
<li class="toctree-l3"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.DINOWM"><code class="docutils literal notranslate"><span class="pre">DINOWM</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.DINOWM.decode"><code class="docutils literal notranslate"><span class="pre">DINOWM.decode()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.DINOWM.encode"><code class="docutils literal notranslate"><span class="pre">DINOWM.encode()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.DINOWM.get_cost"><code class="docutils literal notranslate"><span class="pre">DINOWM.get_cost()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.DINOWM.predict"><code class="docutils literal notranslate"><span class="pre">DINOWM.predict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.DINOWM.replace_action_in_embedding"><code class="docutils literal notranslate"><span class="pre">DINOWM.replace_action_in_embedding()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.DINOWM.rollout"><code class="docutils literal notranslate"><span class="pre">DINOWM.rollout()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.DINOWM.split_embedding"><code class="docutils literal notranslate"><span class="pre">DINOWM.split_embedding()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.DummyWorldModel"><code class="docutils literal notranslate"><span class="pre">DummyWorldModel</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.DummyWorldModel.encode"><code class="docutils literal notranslate"><span class="pre">DummyWorldModel.encode()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.DummyWorldModel.get_cost"><code class="docutils literal notranslate"><span class="pre">DummyWorldModel.get_cost()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="stable_worldmodel.wm.html#stable_worldmodel.wm.DummyWorldModel.predict"><code class="docutils literal notranslate"><span class="pre">DummyWorldModel.predict()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</section>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading">¶</a></h2>
</section>
<section id="module-stable_worldmodel.cli">
<span id="stable-worldmodel-cli-module"></span><h2>stable_worldmodel.cli module<a class="headerlink" href="#module-stable_worldmodel.cli" title="Link to this heading">¶</a></h2>
<p>Command-line interface for stable-worldmodel.</p>
<p>This module provides CLI commands for managing and inspecting stable-worldmodel
resources including datasets, models, and world environments. The CLI uses the
Typer framework with Rich formatting for an enhanced terminal experience.</p>
<dl class="simple">
<dt>Available commands:</dt><dd><ul class="simple">
<li><p>list: List cached models, datasets, or worlds</p></li>
<li><p>show: Display detailed information about datasets or worlds</p></li>
<li><p>delete: Remove models or datasets from cache</p></li>
</ul>
</dd>
<dt>The CLI can be invoked via:</dt><dd><ul class="simple">
<li><p><cite>stable-worldmodel &lt;command&gt;</cite></p></li>
<li><p><cite>swm &lt;command&gt;</cite></p></li>
<li><p><cite>python -m stable_worldmodel.cli &lt;command&gt;</cite></p></li>
</ul>
</dd>
</dl>
<p>Typical usage examples:</p>
<blockquote>
<div><p>List all cached datasets:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ swm list dataset
</pre></div>
</div>
<p>Show information about a specific world:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ swm show world swm/SimplePointMaze-v0
</pre></div>
</div>
<p>Delete a cached dataset:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ swm delete dataset my-dataset
</pre></div>
</div>
<p>Show version:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ swm --version
</pre></div>
</div>
</div></blockquote>
<dl class="py function">
<dt class="sig sig-object py" id="stable_worldmodel.cli.common">
<span class="sig-prename descclassname"><span class="pre">stable_worldmodel.cli.</span></span><span class="sig-name descname"><span class="pre">common</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">version:</span> <span class="pre">~types.Annotated[bool</span> <span class="pre">|</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">&lt;typer.models.OptionInfo</span> <span class="pre">object</span> <span class="pre">at</span> <span class="pre">0x7f7e26817ed0&gt;]</span> <span class="pre">=</span> <span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/cli.html#common"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.cli.common" title="Link to this definition">¶</a></dt>
<dd><p>Common options for all stable-worldmodel commands.</p>
<p>This callback provides global options that apply to all CLI commands.
Currently only supports the –version flag.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>version</strong> (<em>Optional</em><em>[</em><em>bool</em><em>]</em><em>, </em><em>optional</em>) – If True, display version and exit.
Defaults to None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stable_worldmodel.cli.delete">
<span class="sig-prename descclassname"><span class="pre">stable_worldmodel.cli.</span></span><span class="sig-name descname"><span class="pre">delete</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">kind:</span> <span class="pre">~typing.Annotated[str,</span> <span class="pre">&lt;typer.models.ArgumentInfo</span> <span class="pre">object</span> <span class="pre">at</span> <span class="pre">0x7f7e23139c10&gt;],</span> <span class="pre">names:</span> <span class="pre">~typing.Annotated[list[str],</span> <span class="pre">&lt;typer.models.ArgumentInfo</span> <span class="pre">object</span> <span class="pre">at</span> <span class="pre">0x7f7e23139c90&gt;]</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/cli.html#delete"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.cli.delete" title="Link to this definition">¶</a></dt>
<dd><p>Delete models or datasets from cache directory.</p>
<p>Permanently removes specified models or datasets from the local cache directory.
Requires user confirmation before deletion. This operation cannot be undone.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kind</strong> (<em>str</em>) – Type of resource to delete. Must be either:
- ‘model’: Delete cached world models
- ‘dataset’: Delete cached datasets</p></li>
<li><p><strong>names</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>) – One or more names of resources to delete. All specified
names must exist in cache.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>typer.Abort</strong> – If kind is invalid, specified names not found in cache,
    or user cancels the confirmation prompt.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Delete a single dataset:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ swm delete dataset my-dataset
</pre></div>
</div>
<p>Delete multiple models:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ swm delete model model1 model2
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This operation permanently deletes data and cannot be undone. The command
will prompt for confirmation before proceeding.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stable_worldmodel.cli.display_dataset_info">
<span class="sig-prename descclassname"><span class="pre">stable_worldmodel.cli.</span></span><span class="sig-name descname"><span class="pre">display_dataset_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">info</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/stable_worldmodel/cli.html#display_dataset_info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.cli.display_dataset_info" title="Link to this definition">¶</a></dt>
<dd><p>Display dataset information in a formatted panel with tables.</p>
<p>Prints a Rich panel showing dataset metadata including columns, episode count,
shapes, and variation information in a two-table layout.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>info</strong> (<a class="reference internal" href="#stable_worldmodel.spaces.Dict" title="stable_worldmodel.spaces.Dict"><em>Dict</em></a><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>) – Dataset metadata dictionary containing keys:
- ‘name’: Dataset name
- ‘columns’: List of data columns
- ‘num_episodes’: Total number of episodes
- ‘num_steps’: Total number of steps
- ‘obs_shape’: Observation tensor shape
- ‘action_shape’: Action tensor shape
- ‘goal_shape’: Goal tensor shape
- ‘variation’: Variation space structure</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">stable_worldmodel</span><span class="w"> </span><span class="kn">import</span> <span class="n">data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">info</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">dataset_info</span><span class="p">(</span><span class="s2">&quot;simple-pointmaze&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">display_dataset_info</span><span class="p">(</span><span class="n">info</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stable_worldmodel.cli.display_world_info">
<span class="sig-prename descclassname"><span class="pre">stable_worldmodel.cli.</span></span><span class="sig-name descname"><span class="pre">display_world_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">info</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/stable_worldmodel/cli.html#display_world_info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.cli.display_world_info" title="Link to this definition">¶</a></dt>
<dd><p>Display world environment information in a formatted panel.</p>
<p>Prints a Rich panel showing the world’s observation space, action space,
and variation space in a hierarchical, color-coded format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>info</strong> (<a class="reference internal" href="#stable_worldmodel.spaces.Dict" title="stable_worldmodel.spaces.Dict"><em>Dict</em></a><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>) – World metadata dictionary containing keys:
- ‘name’: World environment name
- ‘observation_space’: Observation space structure
- ‘action_space’: Action space structure
- ‘variation’: Variation space structure</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">stable_worldmodel</span><span class="w"> </span><span class="kn">import</span> <span class="n">data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">info</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">world_info</span><span class="p">(</span><span class="s2">&quot;swm/SimplePointMaze-v0&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">display_world_info</span><span class="p">(</span><span class="n">info</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stable_worldmodel.cli.list_cmd">
<span class="sig-prename descclassname"><span class="pre">stable_worldmodel.cli.</span></span><span class="sig-name descname"><span class="pre">list_cmd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">kind:</span> <span class="pre">~typing.Annotated[str,</span> <span class="pre">&lt;typer.models.ArgumentInfo</span> <span class="pre">object</span> <span class="pre">at</span> <span class="pre">0x7f7e2352d010&gt;]</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/cli.html#list_cmd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.cli.list_cmd" title="Link to this definition">¶</a></dt>
<dd><p>List cached stable-worldmodel resources.</p>
<p>Displays a table of all cached models, datasets, or worlds stored in the
stable-worldmodel cache directory. Useful for seeing what resources are
available locally.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>kind</strong> (<em>str</em>) – Type of resource to list. Must be one of:
- ‘model’: List cached world models
- ‘dataset’: List cached datasets
- ‘world’: List registered world environments</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>typer.Abort</strong> – If kind is not ‘model’, ‘dataset’, or ‘world’.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>List all cached datasets:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ swm list dataset
</pre></div>
</div>
<p>List all available worlds:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ swm list world
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stable_worldmodel.cli.show">
<span class="sig-prename descclassname"><span class="pre">stable_worldmodel.cli.</span></span><span class="sig-name descname"><span class="pre">show</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">kind:</span> <span class="pre">~typing.Annotated[str,</span> <span class="pre">&lt;typer.models.ArgumentInfo</span> <span class="pre">object</span> <span class="pre">at</span> <span class="pre">0x7f7e249142d0&gt;],</span> <span class="pre">names:</span> <span class="pre">~types.Annotated[list[str]</span> <span class="pre">|</span> <span class="pre">None,</span> <span class="pre">&lt;typer.models.ArgumentInfo</span> <span class="pre">object</span> <span class="pre">at</span> <span class="pre">0x7f7e231391d0&gt;]</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">all:</span> <span class="pre">~typing.Annotated[bool,</span> <span class="pre">&lt;typer.models.OptionInfo</span> <span class="pre">object</span> <span class="pre">at</span> <span class="pre">0x7f7e23139ed0&gt;]</span> <span class="pre">=</span> <span class="pre">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/cli.html#show"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.cli.show" title="Link to this definition">¶</a></dt>
<dd><p>Show detailed information about datasets or worlds.</p>
<p>Displays comprehensive information about specified datasets or world environments
including their structure, spaces, and variations. Information is presented in
formatted panels with hierarchical trees and tables.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kind</strong> (<em>str</em>) – Type of resource to show. Must be either:
- ‘dataset’: Show dataset information
- ‘world’: Show world environment information</p></li>
<li><p><strong>names</strong> (<em>Optional</em><em>[</em><em>List</em><em>[</em><em>str</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – Specific names to display. Can provide
multiple names. Defaults to None.</p></li>
<li><p><strong>all</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, show information for all cached resources of
the specified kind. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>typer.Abort</strong> – If kind is invalid, no names provided without –all flag,
    or if specified names are not found in cache.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Show a specific dataset:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ swm show dataset simple-pointmaze
</pre></div>
</div>
<p>Show multiple datasets:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ swm show dataset dataset1 dataset2
</pre></div>
</div>
<p>Show all cached datasets:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ swm show dataset --all
</pre></div>
</div>
<p>Show a specific world:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ swm show world swm/SimplePointMaze-v0
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-stable_worldmodel.data">
<span id="stable-worldmodel-data-module"></span><h2>stable_worldmodel.data module<a class="headerlink" href="#module-stable_worldmodel.data" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="stable_worldmodel.data.SpaceInfo">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">stable_worldmodel.data.</span></span><span class="sig-name descname"><span class="pre">SpaceInfo</span></span><a class="reference internal" href="_modules/stable_worldmodel/data.html#SpaceInfo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.data.SpaceInfo" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">TypedDict</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="stable_worldmodel.data.SpaceInfo.dtype">
<span class="sig-name descname"><span class="pre">dtype</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#stable_worldmodel.data.SpaceInfo.dtype" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stable_worldmodel.data.SpaceInfo.high">
<span class="sig-name descname"><span class="pre">high</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Any</span></em><a class="headerlink" href="#stable_worldmodel.data.SpaceInfo.high" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stable_worldmodel.data.SpaceInfo.low">
<span class="sig-name descname"><span class="pre">low</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Any</span></em><a class="headerlink" href="#stable_worldmodel.data.SpaceInfo.low" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stable_worldmodel.data.SpaceInfo.n">
<span class="sig-name descname"><span class="pre">n</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#stable_worldmodel.data.SpaceInfo.n" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stable_worldmodel.data.SpaceInfo.shape">
<span class="sig-name descname"><span class="pre">shape</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#stable_worldmodel.data.SpaceInfo.shape" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stable_worldmodel.data.SpaceInfo.type">
<span class="sig-name descname"><span class="pre">type</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#stable_worldmodel.data.SpaceInfo.type" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stable_worldmodel.data.StepsDataset">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">stable_worldmodel.data.</span></span><span class="sig-name descname"><span class="pre">StepsDataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frameskip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/data.html#StepsDataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.data.StepsDataset" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">HFDataset</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.data.StepsDataset.get_episode_slice">
<span class="sig-name descname"><span class="pre">get_episode_slice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">episode_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">episode_indices</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/data.html#StepsDataset.get_episode_slice"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.data.StepsDataset.get_episode_slice" title="Link to this definition">¶</a></dt>
<dd><p>Return number of possible slices for a given episode index</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.data.StepsDataset.infer_img_path_columns">
<span class="sig-name descname"><span class="pre">infer_img_path_columns</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/data.html#StepsDataset.infer_img_path_columns"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.data.StepsDataset.infer_img_path_columns" title="Link to this definition">¶</a></dt>
<dd><p>Return list of columns that contain image file paths.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stable_worldmodel.data.VariationInfo">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">stable_worldmodel.data.</span></span><span class="sig-name descname"><span class="pre">VariationInfo</span></span><a class="reference internal" href="_modules/stable_worldmodel/data.html#VariationInfo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.data.VariationInfo" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">TypedDict</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="stable_worldmodel.data.VariationInfo.has_variation">
<span class="sig-name descname"><span class="pre">has_variation</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#stable_worldmodel.data.VariationInfo.has_variation" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stable_worldmodel.data.VariationInfo.names">
<span class="sig-name descname"><span class="pre">names</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#stable_worldmodel.data.VariationInfo.names" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stable_worldmodel.data.VariationInfo.type">
<span class="sig-name descname"><span class="pre">type</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#stable_worldmodel.data.VariationInfo.type" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stable_worldmodel.data.WorldInfo">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">stable_worldmodel.data.</span></span><span class="sig-name descname"><span class="pre">WorldInfo</span></span><a class="reference internal" href="_modules/stable_worldmodel/data.html#WorldInfo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.data.WorldInfo" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">TypedDict</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="stable_worldmodel.data.WorldInfo.action_space">
<span class="sig-name descname"><span class="pre">action_space</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#stable_worldmodel.data.SpaceInfo" title="stable_worldmodel.data.SpaceInfo"><span class="pre">SpaceInfo</span></a></em><a class="headerlink" href="#stable_worldmodel.data.WorldInfo.action_space" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stable_worldmodel.data.WorldInfo.config">
<span class="sig-name descname"><span class="pre">config</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#stable_worldmodel.data.WorldInfo.config" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stable_worldmodel.data.WorldInfo.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#stable_worldmodel.data.WorldInfo.name" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stable_worldmodel.data.WorldInfo.observation_space">
<span class="sig-name descname"><span class="pre">observation_space</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#stable_worldmodel.data.SpaceInfo" title="stable_worldmodel.data.SpaceInfo"><span class="pre">SpaceInfo</span></a></em><a class="headerlink" href="#stable_worldmodel.data.WorldInfo.observation_space" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stable_worldmodel.data.WorldInfo.variation">
<span class="sig-name descname"><span class="pre">variation</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#stable_worldmodel.data.VariationInfo" title="stable_worldmodel.data.VariationInfo"><span class="pre">VariationInfo</span></a></em><a class="headerlink" href="#stable_worldmodel.data.WorldInfo.variation" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stable_worldmodel.data.dataset_info">
<span class="sig-prename descclassname"><span class="pre">stable_worldmodel.data.</span></span><span class="sig-name descname"><span class="pre">dataset_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/data.html#dataset_info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.data.dataset_info" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stable_worldmodel.data.delete_dataset">
<span class="sig-prename descclassname"><span class="pre">stable_worldmodel.data.</span></span><span class="sig-name descname"><span class="pre">delete_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/data.html#delete_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.data.delete_dataset" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stable_worldmodel.data.delete_model">
<span class="sig-prename descclassname"><span class="pre">stable_worldmodel.data.</span></span><span class="sig-name descname"><span class="pre">delete_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/data.html#delete_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.data.delete_model" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stable_worldmodel.data.get_cache_dir">
<span class="sig-prename descclassname"><span class="pre">stable_worldmodel.data.</span></span><span class="sig-name descname"><span class="pre">get_cache_dir</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="_modules/stable_worldmodel/data.html#get_cache_dir"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.data.get_cache_dir" title="Link to this definition">¶</a></dt>
<dd><p>Return the cache directory for stable_worldmodel.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stable_worldmodel.data.is_image">
<span class="sig-prename descclassname"><span class="pre">stable_worldmodel.data.</span></span><span class="sig-name descname"><span class="pre">is_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/data.html#is_image"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.data.is_image" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stable_worldmodel.data.list_datasets">
<span class="sig-prename descclassname"><span class="pre">stable_worldmodel.data.</span></span><span class="sig-name descname"><span class="pre">list_datasets</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/data.html#list_datasets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.data.list_datasets" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stable_worldmodel.data.list_models">
<span class="sig-prename descclassname"><span class="pre">stable_worldmodel.data.</span></span><span class="sig-name descname"><span class="pre">list_models</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/data.html#list_models"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.data.list_models" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stable_worldmodel.data.list_worlds">
<span class="sig-prename descclassname"><span class="pre">stable_worldmodel.data.</span></span><span class="sig-name descname"><span class="pre">list_worlds</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/data.html#list_worlds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.data.list_worlds" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stable_worldmodel.data.world_info">
<span class="sig-prename descclassname"><span class="pre">stable_worldmodel.data.</span></span><span class="sig-name descname"><span class="pre">world_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_shape</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(224,</span> <span class="pre">224)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">render_mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'rgb_array'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#stable_worldmodel.data.WorldInfo" title="stable_worldmodel.data.WorldInfo"><span class="pre">WorldInfo</span></a></span></span><a class="reference internal" href="_modules/stable_worldmodel/data.html#world_info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.data.world_info" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="module-stable_worldmodel.policy">
<span id="stable-worldmodel-policy-module"></span><h2>stable_worldmodel.policy module<a class="headerlink" href="#module-stable_worldmodel.policy" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="stable_worldmodel.policy.AutoCostModel">
<span class="sig-prename descclassname"><span class="pre">stable_worldmodel.policy.</span></span><span class="sig-name descname"><span class="pre">AutoCostModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/policy.html#AutoCostModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.policy.AutoCostModel" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stable_worldmodel.policy.BasePolicy">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">stable_worldmodel.policy.</span></span><span class="sig-name descname"><span class="pre">BasePolicy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/policy.html#BasePolicy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.policy.BasePolicy" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Base class for agent policies.</p>
<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.policy.BasePolicy.get_action">
<span class="sig-name descname"><span class="pre">get_action</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/policy.html#BasePolicy.get_action"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.policy.BasePolicy.get_action" title="Link to this definition">¶</a></dt>
<dd><p>Get action from the policy given the observation.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.policy.BasePolicy.set_env">
<span class="sig-name descname"><span class="pre">set_env</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/policy.html#BasePolicy.set_env"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.policy.BasePolicy.set_env" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stable_worldmodel.policy.ExpertPolicy">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">stable_worldmodel.policy.</span></span><span class="sig-name descname"><span class="pre">ExpertPolicy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/policy.html#ExpertPolicy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.policy.ExpertPolicy" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#stable_worldmodel.policy.BasePolicy" title="stable_worldmodel.policy.BasePolicy"><code class="xref py py-class docutils literal notranslate"><span class="pre">BasePolicy</span></code></a></p>
<p>Expert Policy.</p>
<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.policy.ExpertPolicy.get_action">
<span class="sig-name descname"><span class="pre">get_action</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">goal_obs</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/policy.html#ExpertPolicy.get_action"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.policy.ExpertPolicy.get_action" title="Link to this definition">¶</a></dt>
<dd><p>Get action from the policy given the observation.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stable_worldmodel.policy.PlanConfig">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">stable_worldmodel.policy.</span></span><span class="sig-name descname"><span class="pre">PlanConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">horizon</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">receding_horizon</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">history_len</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action_block</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">warm_start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/policy.html#PlanConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.policy.PlanConfig" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Configuration for the planning process.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="stable_worldmodel.policy.PlanConfig.action_block">
<span class="sig-name descname"><span class="pre">action_block</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#stable_worldmodel.policy.PlanConfig.action_block" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stable_worldmodel.policy.PlanConfig.history_len">
<span class="sig-name descname"><span class="pre">history_len</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#stable_worldmodel.policy.PlanConfig.history_len" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stable_worldmodel.policy.PlanConfig.horizon">
<span class="sig-name descname"><span class="pre">horizon</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#stable_worldmodel.policy.PlanConfig.horizon" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="stable_worldmodel.policy.PlanConfig.plan_len">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">plan_len</span></span><a class="headerlink" href="#stable_worldmodel.policy.PlanConfig.plan_len" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stable_worldmodel.policy.PlanConfig.receding_horizon">
<span class="sig-name descname"><span class="pre">receding_horizon</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#stable_worldmodel.policy.PlanConfig.receding_horizon" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stable_worldmodel.policy.PlanConfig.warm_start">
<span class="sig-name descname"><span class="pre">warm_start</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#stable_worldmodel.policy.PlanConfig.warm_start" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stable_worldmodel.policy.RandomPolicy">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">stable_worldmodel.policy.</span></span><span class="sig-name descname"><span class="pre">RandomPolicy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/policy.html#RandomPolicy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.policy.RandomPolicy" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#stable_worldmodel.policy.BasePolicy" title="stable_worldmodel.policy.BasePolicy"><code class="xref py py-class docutils literal notranslate"><span class="pre">BasePolicy</span></code></a></p>
<p>Random Policy.</p>
<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.policy.RandomPolicy.get_action">
<span class="sig-name descname"><span class="pre">get_action</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/policy.html#RandomPolicy.get_action"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.policy.RandomPolicy.get_action" title="Link to this definition">¶</a></dt>
<dd><p>Get action from the policy given the observation.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.policy.RandomPolicy.set_seed">
<span class="sig-name descname"><span class="pre">set_seed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/policy.html#RandomPolicy.set_seed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.policy.RandomPolicy.set_seed" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stable_worldmodel.policy.WorldModelPolicy">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">stable_worldmodel.policy.</span></span><span class="sig-name descname"><span class="pre">WorldModelPolicy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solver</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="stable_worldmodel.solver.html#stable_worldmodel.solver.solver.Solver" title="stable_worldmodel.solver.solver.Solver"><span class="pre">Solver</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#stable_worldmodel.policy.PlanConfig" title="stable_worldmodel.policy.PlanConfig"><span class="pre">PlanConfig</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/policy.html#WorldModelPolicy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.policy.WorldModelPolicy" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#stable_worldmodel.policy.BasePolicy" title="stable_worldmodel.policy.BasePolicy"><code class="xref py py-class docutils literal notranslate"><span class="pre">BasePolicy</span></code></a></p>
<p>World Model Policy using a planning solver.</p>
<dl class="py property">
<dt class="sig sig-object py" id="stable_worldmodel.policy.WorldModelPolicy.flatten_receding_horizon">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">flatten_receding_horizon</span></span><a class="headerlink" href="#stable_worldmodel.policy.WorldModelPolicy.flatten_receding_horizon" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.policy.WorldModelPolicy.get_action">
<span class="sig-name descname"><span class="pre">get_action</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">info_dict</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/policy.html#WorldModelPolicy.get_action"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.policy.WorldModelPolicy.get_action" title="Link to this definition">¶</a></dt>
<dd><p>Get action from the policy given the observation.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.policy.WorldModelPolicy.set_env">
<span class="sig-name descname"><span class="pre">set_env</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/policy.html#WorldModelPolicy.set_env"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.policy.WorldModelPolicy.set_env" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-stable_worldmodel.spaces">
<span id="stable-worldmodel-spaces-module"></span><h2>stable_worldmodel.spaces module<a class="headerlink" href="#module-stable_worldmodel.spaces" title="Link to this heading">¶</a></h2>
<p>Extended Gymnasium spaces with state tracking and constraint support.</p>
<p>This module provides custom Gymnasium space classes that extend the standard
Gymnasium spaces with additional functionality for managing environment variations
and initial conditions. Unlike traditional Gymnasium spaces which primarily define
boundaries for action and observation spaces in RL environments, these extended
spaces are designed to:</p>
<ol class="arabic simple">
<li><p><strong>Track current state</strong>: Each space maintains a current value in addition to
defining valid boundaries.</p></li>
<li><p><strong>Support initial values</strong>: Spaces can be initialized with specific values that
represent the starting state for environment episodes.</p></li>
<li><p><strong>Enable constraint functions</strong>: Optional user-defined predicates for rejection
sampling ensure sampled values satisfy custom conditions.</p></li>
<li><p><strong>Provide ordered sampling</strong>: Dict spaces support explicit sampling order for
handling dependencies between variables.</p></li>
</ol>
<p>These spaces are particularly useful for defining procedurally generated environments
or environments with configurable parameters, where each space represents a variable
aspect of the environment that can be sampled, reset, and validated.</p>
<dl class="simple">
<dt>Classes:</dt><dd><dl class="simple">
<dt>Discrete: Extended discrete space with state tracking and constraint support.</dt><dd><p>Supports integer values in range [0, n) with optional constraint function.</p>
</dd>
<dt>MultiDiscrete: Extended multi-discrete space with state tracking.</dt><dd><p>Represents multiple discrete values with different ranges (nvec).</p>
</dd>
<dt>Box: Extended continuous box space with constraint support.</dt><dd><p>Represents bounded continuous values with configurable shape and dtype.</p>
</dd>
<dt>RGBBox: Specialized box space for RGB image data.</dt><dd><p>Automatically constrains to 3-channel uint8 images with values [0, 255].</p>
</dd>
<dt>Dict: Extended dictionary space with ordered sampling and nesting support.</dt><dd><p>Composes multiple spaces with dependencies and hierarchical structure.</p>
</dd>
</dl>
</dd>
</dl>
<p>Typical usage example:</p>
<blockquote>
<div><p>Create a constrained discrete space that only samples even numbers:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">stable_worldmodel</span><span class="w"> </span><span class="kn">import</span> <span class="n">spaces</span>

<span class="n">even_space</span> <span class="o">=</span> <span class="n">spaces</span><span class="o">.</span><span class="n">Discrete</span><span class="p">(</span>
    <span class="n">n</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">init_value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">constrain_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span>
<span class="p">)</span>

<span class="c1"># Sample valid even numbers</span>
<span class="n">value</span> <span class="o">=</span> <span class="n">even_space</span><span class="o">.</span><span class="n">sample</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sampled: </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">, Current: </span><span class="si">{</span><span class="n">even_space</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Reset to initial value</span>
<span class="n">even_space</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
</pre></div>
</div>
<p>Create a nested dictionary space with sampling order:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">stable_worldmodel</span><span class="w"> </span><span class="kn">import</span> <span class="n">spaces</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="n">env_config</span> <span class="o">=</span> <span class="n">spaces</span><span class="o">.</span><span class="n">Dict</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;difficulty&quot;</span><span class="p">:</span> <span class="n">spaces</span><span class="o">.</span><span class="n">Discrete</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">init_value</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
        <span class="s2">&quot;agent_pos&quot;</span><span class="p">:</span> <span class="n">spaces</span><span class="o">.</span><span class="n">Box</span><span class="p">(</span>
            <span class="n">low</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span>
            <span class="n">high</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">]),</span>
            <span class="n">init_value</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">]),</span>
        <span class="p">),</span>
        <span class="s2">&quot;goal_pos&quot;</span><span class="p">:</span> <span class="n">spaces</span><span class="o">.</span><span class="n">Box</span><span class="p">(</span>
            <span class="n">low</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span>
            <span class="n">high</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">]),</span>
            <span class="n">init_value</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">]),</span>
        <span class="p">),</span>
    <span class="p">},</span>
    <span class="n">sampling_order</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;difficulty&quot;</span><span class="p">,</span> <span class="s2">&quot;goal_pos&quot;</span><span class="p">,</span> <span class="s2">&quot;agent_pos&quot;</span><span class="p">],</span>
<span class="p">)</span>

<span class="c1"># Sample respects the specified order</span>
<span class="n">config</span> <span class="o">=</span> <span class="n">env_config</span><span class="o">.</span><span class="n">sample</span><span class="p">()</span>

<span class="c1"># Access nested values</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Difficulty: </span><span class="si">{</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;difficulty&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Create an RGB image space:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">stable_worldmodel</span><span class="w"> </span><span class="kn">import</span> <span class="n">spaces</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="n">image_space</span> <span class="o">=</span> <span class="n">spaces</span><span class="o">.</span><span class="n">RGBBox</span><span class="p">(</span>
    <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">init_value</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Sample random RGB image</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">image_space</span><span class="o">.</span><span class="n">sample</span><span class="p">()</span>
</pre></div>
</div>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">ivar This module does not define any module-level variables.<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>These spaces extend <code class="docutils literal notranslate"><span class="pre">gymnasium.spaces</span></code> classes and maintain API compatibility
while adding state management features. The <code class="docutils literal notranslate"><span class="pre">sample()</span></code> method performs
rejection sampling when a <code class="docutils literal notranslate"><span class="pre">constrain_fn</span></code> is provided, which may impact
performance if constraints are difficult to satisfy.</p>
<dl class="simple">
<dt>All spaces support the following additional parameters:</dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">init_value</span></code>: Initial value for the space (returned by reset)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">constrain_fn</span></code>: Optional callable returning bool for validation</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">max_tries</span></code>: Maximum rejection sampling attempts (default: 1000)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">warn_after_s</span></code>: Warning threshold for slow sampling (default: 5.0s)</p></li>
</ul>
</dd>
</dl>
<p><strong>Important</strong>: When accessing values in constraint functions for nested Dict
spaces, prefer using <code class="docutils literal notranslate"><span class="pre">space.value['key']['key2']</span></code> over
<code class="docutils literal notranslate"><span class="pre">space['key']['key2'].value</span></code>. The <code class="docutils literal notranslate"><span class="pre">.value</span></code> property recursively
constructs the complete value dictionary top-down with all current information,
while direct space access only retrieves the individual subspace’s value.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>stable_worldmodel.world: World class that composes these spaces
stable_worldmodel.envs: Environment implementations using these spaces
gymnasium.spaces: Base Gymnasium spaces documentation</p>
</div>
<div class="admonition-todo admonition" id="id1">
<p class="admonition-title">Todo</p>
<ul class="simple">
<li><p>Achieve full test coverage for the module</p></li>
<li><p>Implement automatic type casting for init_value to match space dtype</p></li>
<li><p>Add serialization/deserialization support for saving space states</p></li>
<li><p>Optimize constraint checking for large spaces (e.g. MultiDiscrete)</p></li>
</ul>
</div>
<dl class="py class">
<dt class="sig sig-object py" id="stable_worldmodel.spaces.Box">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">stable_worldmodel.spaces.</span></span><span class="sig-name descname"><span class="pre">Box</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constrain_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/spaces.html#Box"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.spaces.Box" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Box</span></code></p>
<p>Extended continuous box space with state tracking and constraint support.</p>
<p>This class extends <code class="docutils literal notranslate"><span class="pre">gymnasium.spaces.Box</span></code> to add state management and
optional constraint validation. It represents bounded continuous values
with configurable shape, dtype, and custom constraints.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>init_value</strong> (<em>np.ndarray</em>) – The initial value for the space.</p></li>
<li><p><strong>value</strong> (<em>np.ndarray</em>) – The current value of the space.</p></li>
<li><p><strong>constrain_fn</strong> (<em>callable</em>) – Optional function that returns True if a
value satisfies custom constraints beyond the box boundaries.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Create a 2D position space constrained to a circle:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>


<span class="k">def</span><span class="w"> </span><span class="nf">in_circle</span><span class="p">(</span><span class="n">pos</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">1.0</span>


<span class="n">space</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span>
    <span class="n">low</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">]),</span>
    <span class="n">high</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]),</span>
    <span class="n">init_value</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]),</span>
    <span class="n">constrain_fn</span><span class="o">=</span><span class="n">in_circle</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">position</span> <span class="o">=</span> <span class="n">space</span><span class="o">.</span><span class="n">sample</span><span class="p">()</span>  <span class="c1"># Only samples within unit circle</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The constraint function enables complex geometric or relational
constraints beyond simple box boundaries.</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.spaces.Box.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constrain_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/spaces.html#Box.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.spaces.Box.__init__" title="Link to this definition">¶</a></dt>
<dd><p>Initialize a Box space with state tracking.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*args</strong> – Positional arguments passed to gymnasium.spaces.Box.</p></li>
<li><p><strong>init_value</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – Initial value for the space.
Must match the shape and dtype of the box. Defaults to None.</p></li>
<li><p><strong>constrain_fn</strong> (<em>callable</em><em>, </em><em>optional</em>) – Function that takes a numpy array
and returns True if the value satisfies custom constraints beyond
the box boundaries. Defaults to None.</p></li>
<li><p><strong>**kwargs</strong> – Keyword arguments passed to gymnasium.spaces.Box.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.spaces.Box.check">
<span class="sig-name descname"><span class="pre">check</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/spaces.html#Box.check"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.spaces.Box.check" title="Link to this definition">¶</a></dt>
<dd><p>Validate the current space value.</p>
<p>Checks if the current value is within the box bounds and satisfies
the constraint function. Logs a warning if the constraint fails.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>True if the current value is valid, False otherwise.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.spaces.Box.contains">
<span class="sig-name descname"><span class="pre">contains</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/spaces.html#Box.contains"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.spaces.Box.contains" title="Link to this definition">¶</a></dt>
<dd><p>Check if value is valid and satisfies constraints.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>np.ndarray</em>) – The value to check.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>True if x is within box bounds and satisfies the constraint</dt><dd><p>function, False otherwise.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="stable_worldmodel.spaces.Box.init_value">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">init_value</span></span><a class="headerlink" href="#stable_worldmodel.spaces.Box.init_value" title="Link to this definition">¶</a></dt>
<dd><p>The initial value of the space, returned by reset().</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.spaces.Box.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/spaces.html#Box.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.spaces.Box.reset" title="Link to this definition">¶</a></dt>
<dd><p>Reset the space value to its initial value.</p>
<p>Sets the current value back to the init_value specified during
initialization.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.spaces.Box.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_tries</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">warn_after_s</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/spaces.html#Box.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.spaces.Box.sample" title="Link to this definition">¶</a></dt>
<dd><p>Sample a random value using rejection sampling for constraints.</p>
<p>Repeatedly samples values until one satisfies the constraint function
or max_tries is reached. Optionally updates the space’s current value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*args</strong> – Positional arguments passed to gymnasium.spaces.Box.sample().</p></li>
<li><p><strong>max_tries</strong> (<em>int</em><em>, </em><em>optional</em>) – Maximum number of sampling attempts before
raising an error. Defaults to 1000.</p></li>
<li><p><strong>warn_after_s</strong> (<em>float</em><em>, </em><em>optional</em>) – Time threshold in seconds after which
to log a warning about slow sampling. Set to None to disable.
Defaults to 5.0.</p></li>
<li><p><strong>set_value</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to update the space’s current
value with the sampled value. Defaults to True.</p></li>
<li><p><strong>**kwargs</strong> – Keyword arguments passed to gymnasium.spaces.Box.sample().</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A sampled array that satisfies the constraint function.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>RuntimeError</strong> – If no valid sample is found after max_tries attempts.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="stable_worldmodel.spaces.Box.value">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">value</span></span><a class="headerlink" href="#stable_worldmodel.spaces.Box.value" title="Link to this definition">¶</a></dt>
<dd><p>The current value of the space.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stable_worldmodel.spaces.Dict">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">stable_worldmodel.spaces.</span></span><span class="sig-name descname"><span class="pre">Dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constrain_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/spaces.html#Dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.spaces.Dict" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code></p>
<p>Extended dictionary space with ordered sampling and nested support.</p>
<p>This class extends <code class="docutils literal notranslate"><span class="pre">gymnasium.spaces.Dict</span></code> to add state management,
constraint validation, and explicit sampling order control. It composes
multiple spaces into a hierarchical structure where dependencies between
variables can be handled through ordered sampling.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*args</strong> – Positional arguments passed to gymnasium.spaces.Dict.</p></li>
<li><p><strong>init_value</strong> (<em>dict</em><em>, </em><em>optional</em>) – Initial values for the space. If None,
derived from init_value of contained spaces.</p></li>
<li><p><strong>constrain_fn</strong> (<em>callable</em><em>, </em><em>optional</em>) – Function that returns True if the
complete dictionary satisfies custom constraints.</p></li>
<li><p><strong>sampling_order</strong> (<em>list</em><em>, </em><em>optional</em>) – Explicit order for sampling keys.
If None, uses insertion order. Missing keys are appended.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments passed to Dict.</p></li>
</ul>
</dd>
<dt class="field-even">Variables<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>init_value</strong> (<em>dict</em>) – Initial values for all contained spaces.</p></li>
<li><p><strong>value</strong> (<em>dict</em>) – Current values of all contained spaces.</p></li>
<li><p><strong>constrain_fn</strong> (<em>callable</em>) – Constraint validation function.</p></li>
<li><p><strong>sampling_order</strong> (<em>set</em>) – Set of dotted paths for all variables in order.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Create a nested space with sampling order dependencies:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">stable_worldmodel</span><span class="w"> </span><span class="kn">import</span> <span class="n">spaces</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="n">config</span> <span class="o">=</span> <span class="n">spaces</span><span class="o">.</span><span class="n">Dict</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;difficulty&quot;</span><span class="p">:</span> <span class="n">spaces</span><span class="o">.</span><span class="n">Discrete</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">init_value</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
        <span class="s2">&quot;world&quot;</span><span class="p">:</span> <span class="n">spaces</span><span class="o">.</span><span class="n">Dict</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;width&quot;</span><span class="p">:</span> <span class="n">spaces</span><span class="o">.</span><span class="n">Discrete</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">init_value</span><span class="o">=</span><span class="mi">50</span><span class="p">),</span>
                <span class="s2">&quot;height&quot;</span><span class="p">:</span> <span class="n">spaces</span><span class="o">.</span><span class="n">Discrete</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">init_value</span><span class="o">=</span><span class="mi">50</span><span class="p">),</span>
            <span class="p">}</span>
        <span class="p">),</span>
        <span class="s2">&quot;player_pos&quot;</span><span class="p">:</span> <span class="n">spaces</span><span class="o">.</span><span class="n">Box</span><span class="p">(</span>
            <span class="n">low</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span>
            <span class="n">high</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">99</span><span class="p">,</span> <span class="mi">99</span><span class="p">]),</span>
            <span class="n">init_value</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">25</span><span class="p">,</span> <span class="mi">25</span><span class="p">]),</span>
        <span class="p">),</span>
    <span class="p">},</span>
    <span class="n">sampling_order</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;difficulty&quot;</span><span class="p">,</span> <span class="s2">&quot;world&quot;</span><span class="p">,</span> <span class="s2">&quot;player_pos&quot;</span><span class="p">],</span>
<span class="p">)</span>

<span class="c1"># Sample respects order</span>
<span class="n">state</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">sample</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Sampling order is crucial when variables have dependencies. For
example, sample world size before sampling positions within it.
Nested Dict spaces recursively apply their own sampling orders.</p>
<p><strong>Accessing values in constraint functions</strong>: When implementing
<code class="docutils literal notranslate"><span class="pre">constrain_fn</span></code> for Dict spaces, always use <code class="docutils literal notranslate"><span class="pre">self.value['key']['key2']</span></code>
instead of <code class="docutils literal notranslate"><span class="pre">self['key']['key2'].value</span></code>. The <code class="docutils literal notranslate"><span class="pre">.value</span></code> property
recursively builds the complete value dictionary from the top level down,
ensuring all nested values are up-to-date and correctly structured. Direct
subspace access with <code class="docutils literal notranslate"><span class="pre">.value</span></code> only retrieves that specific subspace’s
value without the full context.</p>
<p>Note that direct subspace access (e.g., <code class="docutils literal notranslate"><span class="pre">self['key'].value</span></code>) is perfectly
fine for regular operations outside of constraint functions, such as reading
individual subspace values or debugging. The recommendation to use top-level
<code class="docutils literal notranslate"><span class="pre">.value</span></code> applies specifically to constraint functions where you need the
complete, consistent state of all nested spaces.</p>
<p>Example of proper constraint function usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example: In a class with Dict space attribute</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Environment</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config_space</span> <span class="o">=</span> <span class="n">spaces</span><span class="o">.</span><span class="n">Dict</span><span class="p">({</span><span class="o">...</span><span class="p">})</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">validate_config</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># ✓ CORRECT: Access via .value at top level</span>
        <span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config_space</span><span class="o">.</span><span class="n">value</span>
        <span class="k">return</span> <span class="n">values</span><span class="p">[</span><span class="s2">&quot;player_pos&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">values</span><span class="p">[</span><span class="s2">&quot;world&quot;</span><span class="p">][</span><span class="s2">&quot;width&quot;</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">validate_wrong</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># ✗ AVOID: Direct subspace access</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">config_space</span><span class="p">[</span><span class="s2">&quot;player_pos&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">config_space</span><span class="p">[</span><span class="s2">&quot;world&quot;</span><span class="p">][</span><span class="s2">&quot;width&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
        <span class="p">)</span>
</pre></div>
</div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.spaces.Dict.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constrain_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/spaces.html#Dict.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.spaces.Dict.__init__" title="Link to this definition">¶</a></dt>
<dd><p>Initialize a Dict space with state tracking and sampling order.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*args</strong> – Positional arguments passed to gymnasium.spaces.Dict.</p></li>
<li><p><strong>init_value</strong> (<em>dict</em><em>, </em><em>optional</em>) – Initial values for the space. If None,
derived from init_value of contained spaces. Defaults to None.</p></li>
<li><p><strong>constrain_fn</strong> (<em>callable</em><em>, </em><em>optional</em>) – Function that takes a dict and
returns True if the complete dictionary satisfies custom constraints.
Defaults to None.</p></li>
<li><p><strong>sampling_order</strong> (<em>list</em><em>, </em><em>optional</em>) – Explicit order for sampling keys.
If None, uses insertion order. Missing keys are appended with warning.
Defaults to None.</p></li>
<li><p><strong>**kwargs</strong> – Keyword arguments passed to gymnasium.spaces.Dict.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If sampling_order contains keys not present in spaces.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.spaces.Dict.check">
<span class="sig-name descname"><span class="pre">check</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/spaces.html#Dict.check"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.spaces.Dict.check" title="Link to this definition">¶</a></dt>
<dd><p>Validate all contained spaces’ current values.</p>
<p>Checks each contained space using its check() method if available,
or falls back to contains(value). Optionally logs warnings for
failed checks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>debug</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, logs warnings for spaces that
fail validation. Defaults to False.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if all contained spaces have valid values, False otherwise.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.spaces.Dict.contains">
<span class="sig-name descname"><span class="pre">contains</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/stable_worldmodel/spaces.html#Dict.contains"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.spaces.Dict.contains" title="Link to this definition">¶</a></dt>
<dd><p>Check if value is a valid member of this space.</p>
<p>Validates that x is a dictionary containing all required keys with
values that satisfy each subspace’s constraints and the overall
constraint function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> – The value to check.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>True if x is a valid dict with all keys present, all values</dt><dd><p>within subspace bounds, and satisfies the constraint function.
False otherwise.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="stable_worldmodel.spaces.Dict.init_value">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">init_value</span></span><a class="headerlink" href="#stable_worldmodel.spaces.Dict.init_value" title="Link to this definition">¶</a></dt>
<dd><p>Initial values for all contained spaces.</p>
<p>Constructs initial value dictionary from contained spaces’ init_value
properties. Falls back to sampling if a space lacks init_value.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dictionary mapping space keys to their initial values.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict</p>
</dd>
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.spaces.Dict.names">
<span class="sig-name descname"><span class="pre">names</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/spaces.html#Dict.names"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.spaces.Dict.names" title="Link to this definition">¶</a></dt>
<dd><p>Return all space keys including nested ones.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>A list of all keys in the Dict space, with nested keys using dot notation.</dt><dd><p>For example, a nested dict with key “a” containing subspace “b” would produce “a.b”.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.spaces.Dict.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/spaces.html#Dict.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.spaces.Dict.reset" title="Link to this definition">¶</a></dt>
<dd><p>Reset all contained spaces to their initial values.</p>
<p>Calls reset() on all contained spaces that have a reset method,
then sets this space’s value to init_value.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.spaces.Dict.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_tries</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">warn_after_s</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/spaces.html#Dict.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.spaces.Dict.sample" title="Link to this definition">¶</a></dt>
<dd><p>Sample a random element from the Dict space.</p>
<p>Samples each subspace in the sampling order and ensures the result satisfies
any constraint functions. Uses rejection sampling if constraints are present.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*args</strong> – Positional arguments passed to each subspace’s sample method.</p></li>
<li><p><strong>max_tries</strong> (<em>int</em><em>, </em><em>optional</em>) – Maximum number of rejection sampling attempts.
Defaults to 1000.</p></li>
<li><p><strong>warn_after_s</strong> (<em>float</em><em>, </em><em>optional</em>) – Issue a warning if sampling takes longer than
this many seconds. Set to None to disable warnings. Defaults to 5.0.</p></li>
<li><p><strong>set_value</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to set the internal value to the sampled value.
Defaults to True.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments passed to each subspace’s sample method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A dictionary with keys matching the space definition and values sampled</dt><dd><p>from their respective subspaces.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>RuntimeError</strong> – If a valid sample is not found within max_tries attempts.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="stable_worldmodel.spaces.Dict.sampling_order">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sampling_order</span></span><a class="headerlink" href="#stable_worldmodel.spaces.Dict.sampling_order" title="Link to this definition">¶</a></dt>
<dd><p>Set of dotted paths for all variables in sampling order.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>Set of strings representing dotted paths (e.g., ‘parent.child.key’)</dt><dd><p>for all variables including nested Dict spaces.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>set</p>
</dd>
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>set</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.spaces.Dict.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keys</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/spaces.html#Dict.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.spaces.Dict.update" title="Link to this definition">¶</a></dt>
<dd><p>Update specific keys in the Dict space by resampling them.</p>
<p>Samples new values for the specified keys while maintaining the sampling order.
Uses dot notation for nested keys (e.g., “a.b” for nested dict).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>keys</strong> (<em>container</em>) – A container (list, set, etc.) of key names to resample.
Keys should use dot notation for nested spaces.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If a specified key is not found in the Dict space.</p></li>
<li><p><strong>AssertionError</strong> – If the updated values violate the space constraints.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="stable_worldmodel.spaces.Dict.value">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">value</span></span><a class="headerlink" href="#stable_worldmodel.spaces.Dict.value" title="Link to this definition">¶</a></dt>
<dd><p>Current values of all contained spaces.</p>
<p>Constructs value dictionary from contained spaces’ value properties.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dictionary mapping space keys to their current values.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong> – If a contained space does not have a value property.</p>
</dd>
<dt class="field-even">Type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stable_worldmodel.spaces.Discrete">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">stable_worldmodel.spaces.</span></span><span class="sig-name descname"><span class="pre">Discrete</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constrain_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/spaces.html#Discrete"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.spaces.Discrete" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Discrete</span></code></p>
<p>Extended discrete space with state tracking and constraint support.</p>
<p>This class extends <code class="docutils literal notranslate"><span class="pre">gymnasium.spaces.Discrete</span></code> to add state management
and optional constraint validation. Unlike the standard discrete space,
this version maintains a current value and supports rejection sampling
via a custom constraint function.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>init_value</strong> (<em>int</em>) – The initial value for the space.</p></li>
<li><p><strong>value</strong> (<em>int</em>) – The current value of the space.</p></li>
<li><p><strong>constrain_fn</strong> (<em>callable</em>) – Optional function that returns True if a
value satisfies custom constraints.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Create a discrete space that only accepts even numbers:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">space</span> <span class="o">=</span> <span class="n">Discrete</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">init_value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">constrain_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">value</span> <span class="o">=</span> <span class="n">space</span><span class="o">.</span><span class="n">sample</span><span class="p">()</span>  <span class="c1"># Samples even number and updates space.value</span>
<span class="n">space</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>  <span class="c1"># Resets space.value back to 0 (init_value)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">sample()</span></code> method uses rejection sampling when a constraint
function is provided, which may impact performance for difficult
constraints.</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.spaces.Discrete.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constrain_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/spaces.html#Discrete.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.spaces.Discrete.__init__" title="Link to this definition">¶</a></dt>
<dd><p>Initialize a Discrete space with state tracking.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*args</strong> – Positional arguments passed to gymnasium.spaces.Discrete.</p></li>
<li><p><strong>init_value</strong> (<em>int</em><em>, </em><em>optional</em>) – Initial value for the space. Defaults to None.</p></li>
<li><p><strong>constrain_fn</strong> (<em>callable</em><em>, </em><em>optional</em>) – Function that takes an int and returns
True if the value satisfies custom constraints. Defaults to None.</p></li>
<li><p><strong>**kwargs</strong> – Keyword arguments passed to gymnasium.spaces.Discrete.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.spaces.Discrete.check">
<span class="sig-name descname"><span class="pre">check</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/spaces.html#Discrete.check"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.spaces.Discrete.check" title="Link to this definition">¶</a></dt>
<dd><p>Validate the current space value.</p>
<p>Checks if the current value is within the space bounds and satisfies
the constraint function. Logs a warning if the constraint fails.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>True if the current value is valid, False otherwise.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.spaces.Discrete.contains">
<span class="sig-name descname"><span class="pre">contains</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/spaces.html#Discrete.contains"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.spaces.Discrete.contains" title="Link to this definition">¶</a></dt>
<dd><p>Check if value is valid and satisfies constraints.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>int</em>) – The value to check.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>True if x is within bounds and satisfies the constraint</dt><dd><p>function, False otherwise.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="stable_worldmodel.spaces.Discrete.init_value">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">init_value</span></span><a class="headerlink" href="#stable_worldmodel.spaces.Discrete.init_value" title="Link to this definition">¶</a></dt>
<dd><p>The initial value of the space, returned by reset().</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.spaces.Discrete.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/spaces.html#Discrete.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.spaces.Discrete.reset" title="Link to this definition">¶</a></dt>
<dd><p>Reset the space value to its initial value.</p>
<p>Sets the current value back to the init_value specified during
initialization.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.spaces.Discrete.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_tries</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">warn_after_s</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/spaces.html#Discrete.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.spaces.Discrete.sample" title="Link to this definition">¶</a></dt>
<dd><p>Sample a random value using rejection sampling for constraints.</p>
<p>Repeatedly samples values until one satisfies the constraint function
or max_tries is reached. Optionally updates the space’s current value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*args</strong> – Positional arguments passed to gymnasium.spaces.Discrete.sample().</p></li>
<li><p><strong>max_tries</strong> (<em>int</em><em>, </em><em>optional</em>) – Maximum number of sampling attempts before
raising an error. Defaults to 1000.</p></li>
<li><p><strong>warn_after_s</strong> (<em>float</em><em>, </em><em>optional</em>) – Time threshold in seconds after which
to log a warning about slow sampling. Set to None to disable.
Defaults to 5.0.</p></li>
<li><p><strong>set_value</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to update the space’s current
value with the sampled value. Defaults to True.</p></li>
<li><p><strong>**kwargs</strong> – Keyword arguments passed to gymnasium.spaces.Discrete.sample().</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A sampled value that satisfies the constraint function.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>RuntimeError</strong> – If no valid sample is found after max_tries attempts.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="stable_worldmodel.spaces.Discrete.value">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">value</span></span><a class="headerlink" href="#stable_worldmodel.spaces.Discrete.value" title="Link to this definition">¶</a></dt>
<dd><p>The current value of the space.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stable_worldmodel.spaces.MultiDiscrete">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">stable_worldmodel.spaces.</span></span><span class="sig-name descname"><span class="pre">MultiDiscrete</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constrain_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/spaces.html#MultiDiscrete"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.spaces.MultiDiscrete" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">MultiDiscrete</span></code></p>
<p>Extended multi-discrete space with state tracking and constraint support.</p>
<p>This class extends <code class="docutils literal notranslate"><span class="pre">gymnasium.spaces.MultiDiscrete</span></code> to add state
management and optional constraint validation. It represents multiple
discrete variables with potentially different ranges (nvec), where each
variable maintains its own value and can be constrained.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>init_value</strong> (<em>np.ndarray</em>) – The initial values for all discrete variables.</p></li>
<li><p><strong>value</strong> (<em>np.ndarray</em>) – The current values of all discrete variables.</p></li>
<li><p><strong>constrain_fn</strong> (<em>callable</em>) – Optional function that returns True if the
entire value array satisfies custom constraints.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Create a multi-discrete space for game difficulty settings:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="n">space</span> <span class="o">=</span> <span class="n">MultiDiscrete</span><span class="p">(</span>
    <span class="n">nvec</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>  <span class="c1"># [enemy_count, speed_level, spawn_rate]</span>
    <span class="n">init_value</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">]),</span>
<span class="p">)</span>
<span class="n">settings</span> <span class="o">=</span> <span class="n">space</span><span class="o">.</span><span class="n">sample</span><span class="p">()</span>  <span class="c1"># Random difficulty configuration</span>
<span class="n">space</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>  <span class="c1"># Resets to [2, 1, 5] (medium difficulty)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Constraints are applied to the entire array, not individual elements.
Use a constraint function that validates the complete state.</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.spaces.MultiDiscrete.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constrain_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/spaces.html#MultiDiscrete.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.spaces.MultiDiscrete.__init__" title="Link to this definition">¶</a></dt>
<dd><p>Initialize a MultiDiscrete space with state tracking.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*args</strong> – Positional arguments passed to gymnasium.spaces.MultiDiscrete.</p></li>
<li><p><strong>init_value</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – Initial values for the space.
Must match the shape defined by nvec. Defaults to None.</p></li>
<li><p><strong>constrain_fn</strong> (<em>callable</em><em>, </em><em>optional</em>) – Function that takes a numpy array
and returns True if the values satisfy custom constraints.
Defaults to None.</p></li>
<li><p><strong>**kwargs</strong> – Keyword arguments passed to gymnasium.spaces.MultiDiscrete.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.spaces.MultiDiscrete.check">
<span class="sig-name descname"><span class="pre">check</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/spaces.html#MultiDiscrete.check"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.spaces.MultiDiscrete.check" title="Link to this definition">¶</a></dt>
<dd><p>Validate the current space values.</p>
<p>Checks if the current values are within the space bounds and satisfy
the constraint function. Logs a warning if the constraint fails.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>True if the current values are valid, False otherwise.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.spaces.MultiDiscrete.contains">
<span class="sig-name descname"><span class="pre">contains</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/spaces.html#MultiDiscrete.contains"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.spaces.MultiDiscrete.contains" title="Link to this definition">¶</a></dt>
<dd><p>Check if values are valid and satisfy constraints.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>np.ndarray</em>) – The array of values to check.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>True if x is within bounds for all elements and satisfies</dt><dd><p>the constraint function, False otherwise.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="stable_worldmodel.spaces.MultiDiscrete.init_value">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">init_value</span></span><a class="headerlink" href="#stable_worldmodel.spaces.MultiDiscrete.init_value" title="Link to this definition">¶</a></dt>
<dd><p>The initial values of the space, returned by reset().</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.spaces.MultiDiscrete.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/spaces.html#MultiDiscrete.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.spaces.MultiDiscrete.reset" title="Link to this definition">¶</a></dt>
<dd><p>Reset the space values to their initial values.</p>
<p>Sets the current values back to the init_value specified during
initialization.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.spaces.MultiDiscrete.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_tries</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">warn_after_s</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/spaces.html#MultiDiscrete.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.spaces.MultiDiscrete.sample" title="Link to this definition">¶</a></dt>
<dd><p>Sample random values using rejection sampling for constraints.</p>
<p>Repeatedly samples value arrays until one satisfies the constraint
function or max_tries is reached. Optionally updates the space’s
current values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*args</strong> – Positional arguments passed to gymnasium.spaces.MultiDiscrete.sample().</p></li>
<li><p><strong>max_tries</strong> (<em>int</em><em>, </em><em>optional</em>) – Maximum number of sampling attempts before
raising an error. Defaults to 1000.</p></li>
<li><p><strong>warn_after_s</strong> (<em>float</em><em>, </em><em>optional</em>) – Time threshold in seconds after which
to log a warning about slow sampling. Set to None to disable.
Defaults to 5.0.</p></li>
<li><p><strong>set_value</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to update the space’s current
values with the sampled values. Defaults to True.</p></li>
<li><p><strong>**kwargs</strong> – Keyword arguments passed to gymnasium.spaces.MultiDiscrete.sample().</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A sampled array that satisfies the constraint function.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>RuntimeError</strong> – If no valid sample is found after max_tries attempts.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="stable_worldmodel.spaces.MultiDiscrete.value">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">value</span></span><a class="headerlink" href="#stable_worldmodel.spaces.MultiDiscrete.value" title="Link to this definition">¶</a></dt>
<dd><p>The current values of the space.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stable_worldmodel.spaces.RGBBox">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">stable_worldmodel.spaces.</span></span><span class="sig-name descname"><span class="pre">RGBBox</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(3,)</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/spaces.html#RGBBox"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.spaces.RGBBox" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#stable_worldmodel.spaces.Box" title="stable_worldmodel.spaces.Box"><code class="xref py py-class docutils literal notranslate"><span class="pre">Box</span></code></a></p>
<p>Specialized box space for RGB image data with automatic constraints.</p>
<p>This class extends <code class="docutils literal notranslate"><span class="pre">Box</span></code> to provide a convenient space for RGB images,
automatically enforcing uint8 dtype and [0, 255] value ranges. It validates
that the shape includes exactly 3 channels for RGB data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shape</strong> (<em>tuple</em>) – Shape of the image. Must include a dimension of size 3
for the RGB channels. Common formats: (H, W, 3) or (3, H, W).</p></li>
<li><p><strong>init_value</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – Initial RGB image. Must match shape
and be uint8 dtype.</p></li>
<li><p><strong>*args</strong> – Additional positional arguments passed to Box.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments passed to Box.</p></li>
</ul>
</dd>
<dt class="field-even">Variables<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>init_value</strong> (<em>np.ndarray</em>) – The initial RGB image.</p></li>
<li><p><strong>value</strong> (<em>np.ndarray</em>) – The current RGB image.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Create a space for 64x64 RGB images:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="n">space</span> <span class="o">=</span> <span class="n">RGBBox</span><span class="p">(</span>
    <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">init_value</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">image</span> <span class="o">=</span> <span class="n">space</span><span class="o">.</span><span class="n">sample</span><span class="p">()</span>  <span class="c1"># Random RGB image</span>
<span class="n">space</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>  <span class="c1"># Returns to black image</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>AssertionError</strong> – If shape does not contain a dimension of size 3.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This space is useful for vision-based environments where images
need to be sampled or tracked as part of environment configuration.
The low, high, and dtype parameters are automatically set and cannot
be overridden.</p>
</div>
</dd></dl>

</section>
<section id="module-stable_worldmodel.utils">
<span id="stable-worldmodel-utils-module"></span><h2>stable_worldmodel.utils module<a class="headerlink" href="#module-stable_worldmodel.utils" title="Link to this heading">¶</a></h2>
<p>Utility functions for stable_worldmodel.</p>
<dl class="py function">
<dt class="sig sig-object py" id="stable_worldmodel.utils.flatten_dict">
<span class="sig-prename descclassname"><span class="pre">stable_worldmodel.utils.</span></span><span class="sig-name descname"><span class="pre">flatten_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'.'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/utils.html#flatten_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.utils.flatten_dict" title="Link to this definition">¶</a></dt>
<dd><p>Flatten a nested dictionary into a single-level dictionary with concatenated keys.</p>
<p>The naming convention for the new keys is similar to Hydra’s, using a <cite>.</cite> separator to denote levels of nesting.
Attention is needed when flattening dictionaries with overlapping keys, as this may lead to information loss.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>d</strong> (<em>dict</em>) – The nested dictionary to flatten.</p></li>
<li><p><strong>parent_key</strong> (<em>str</em><em>, </em><em>optional</em>) – The base key to use for the flattened keys.</p></li>
<li><p><strong>sep</strong> (<em>str</em><em>, </em><em>optional</em>) – The separator to use between levels of nesting. Defaults to ‘.’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A flattened version of the input dictionary.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">info</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;c&quot;</span><span class="p">:</span> <span class="mi">42</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">:</span> <span class="mi">43</span><span class="p">}},</span> <span class="s2">&quot;e&quot;</span><span class="p">:</span> <span class="mi">44</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flatten_dict</span><span class="p">(</span><span class="n">info</span><span class="p">)</span>
<span class="go">{&#39;a.b.c&#39;: 42, &#39;a.b.d&#39;: 43, &#39;e&#39;: 44}</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">flatten_dict</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="s2">&quot;a.b&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">})</span>
<span class="go">{&#39;a.b&#39;: 3}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stable_worldmodel.utils.get_in">
<span class="sig-prename descclassname"><span class="pre">stable_worldmodel.utils.</span></span><span class="sig-name descname"><span class="pre">get_in</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mapping</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="reference internal" href="_modules/stable_worldmodel/utils.html#get_in"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.utils.get_in" title="Link to this definition">¶</a></dt>
<dd><p>Retrieve a value from a nested dictionary using a sequence of keys.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mapping</strong> (<em>dict</em>) – A nested dictionary.</p></li>
<li><p><strong>path</strong> (<em>Iterable</em><em>[</em><em>str</em><em>]</em>) – An iterable of keys representing the path to the desired value in mapping.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The value located at the specified path in the nested dictionary.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Any</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>KeyError</strong> – If any key in the path does not exist in the mapping dict.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">variations</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;c&quot;</span><span class="p">:</span> <span class="mi">42</span><span class="p">}}}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_in</span><span class="p">(</span><span class="n">variations</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">])</span>
<span class="go">42</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stable_worldmodel.utils.pretraining">
<span class="sig-prename descclassname"><span class="pre">stable_worldmodel.utils.</span></span><span class="sig-name descname"><span class="pre">pretraining</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">script_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_model_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dump_object</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="reference internal" href="_modules/stable_worldmodel/utils.html#pretraining"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.utils.pretraining" title="Link to this definition">¶</a></dt>
<dd><p>Run a pretraining script as a subprocess with optional command-line arguments.</p>
<p>This function checks if the specified script exists, constructs a command to run it with the provided arguments,
and executes the command in a subprocess.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>script_path</strong> (<em>str</em>) – The path to the pretraining script to be executed.</p></li>
<li><p><strong>dataset_name</strong> (<em>str</em>) – The name of the dataset to be used in pretraining.</p></li>
<li><p><strong>output_model_name</strong> (<em>str</em>) – The name to save the output model.</p></li>
<li><p><strong>dump_object</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to dump the model object after training. Defaults to</p></li>
<li><p><strong>args</strong> (<em>str</em><em>, </em><em>optional</em>) – A string of command-line arguments to pass to the script. Defaults to an empty string.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The return code of the subprocess. A return code of 0 indicates success.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If the specified script does not exist.</p></li>
<li><p><strong>SystemExit</strong> – If the subprocess exits with a non-zero return code.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-stable_worldmodel.world">
<span id="stable-worldmodel-world-module"></span><h2>stable_worldmodel.world module<a class="headerlink" href="#module-stable_worldmodel.world" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="stable_worldmodel.world.World">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">stable_worldmodel.world.</span></span><span class="sig-name descname"><span class="pre">World</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_envs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_shape</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">goal_shape</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">goal_transform</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_transform</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2349867</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_episode_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/world.html#World"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.world.World" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A high-level environment manager for vectorized gym environments with support for
goal-conditioned tasks, video recording, dataset generation, and evaluation.</p>
<p>The <cite>World</cite> class wraps multiple parallel environments using Gymnasium’s vectorized API and
integrates with custom wrappers (e.g., <cite>MegaWrapper</cite>) to handle image-based observations and goals.
It provides utility methods for recording trajectories, saving datasets in HuggingFace Datasets .parquet format,
evaluating policies, and exporting video rollouts.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env_name</strong> (<em>str</em>) – The name of the Gymnasium environment to instantiate.</p></li>
<li><p><strong>num_envs</strong> (<em>int</em>) – Number of parallel environments to run.</p></li>
<li><p><strong>image_shape</strong> (<em>tuple</em><em>[</em><em>int</em><em>]</em>) – Shape of image observations (C, H, W).</p></li>
<li><p><strong>image_transform</strong> (<em>callable</em><em>, </em><em>optional</em>) – Transformation function applied to image observations.</p></li>
<li><p><strong>goal_shape</strong> (<em>tuple</em><em>[</em><em>int</em><em>]</em><em>, </em><em>optional</em>) – Shape of goal image observations.</p></li>
<li><p><strong>goal_transform</strong> (<em>callable</em><em>, </em><em>optional</em>) – Transformation function applied to goal observations.</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – Random seed for environment initialization and goal sampling.</p></li>
<li><p><strong>max_episode_steps</strong> (<em>int</em><em>, </em><em>default=100</em>) – Maximum number of steps per episode.</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em>) – Additional keyword arguments passed to <cite>gym.make_vec</cite>.</p></li>
<li><p><strong>Attributes</strong></p></li>
<li><p><strong>----------</strong></p></li>
<li><p><strong>envs</strong> (<em>gym.vector.VectorEnv</em>) – Vectorized environments wrapped with <cite>MegaWrapper</cite>.</p></li>
<li><p><strong>goal_envs</strong> (<em>gym.vector.VectorEnv</em>) – Separate vectorized environments for goal sampling.</p></li>
<li><p><strong>seed</strong> – Random seed for reproducibility.</p></li>
<li><p><strong>goal_seed</strong> (<em>int</em>) – Secondary random seed for sampling goals.</p></li>
<li><p><strong>policy</strong> (<em>object</em>) – Policy instance with <cite>get_action</cite> and <cite>set_env</cite> methods.</p></li>
<li><p><strong>Properties</strong></p></li>
<li><p><strong>----------</strong></p></li>
<li><p><strong>num_envs</strong> – Number of environments in the vectorized setup.</p></li>
<li><p><strong>observation_space</strong> (<em>gym.Space</em>) – Observation space of the environments.</p></li>
<li><p><strong>action_space</strong> (<em>gym.Space</em>) – Action space of the environments.</p></li>
<li><p><strong>single_action_space</strong> (<em>gym.Space</em>) – Action space for a single environment.</p></li>
<li><p><strong>single_observation_space</strong> (<em>gym.Space</em>) – Observation space for a single environment.</p></li>
<li><p><strong>Methods</strong></p></li>
<li><p><strong>-------</strong></p></li>
<li><p><strong>close</strong><strong>(</strong><strong>**kwargs</strong><strong>)</strong> – <p>Closes all managed environments.</p>
</p></li>
<li><p><strong>denormalize</strong><strong>(</strong><strong>x</strong><strong>)</strong> – Converts normalized images in [-1, 1] back to [0, 1].</p></li>
<li><p><strong>set_policy</strong><strong>(</strong><strong>policy</strong><strong>)</strong> – Assigns a policy object for interaction.</p></li>
<li><p><strong>reset</strong><strong>(</strong><strong>seed=None</strong> – Resets the environments and returns initial states and infos.</p></li>
<li><p><strong>options=None</strong><strong>)</strong> – Resets the environments and returns initial states and infos.</p></li>
<li><p><strong>step</strong><strong>(</strong><strong>)</strong> – Steps all environments using the current policy’s actions.</p></li>
<li><p><strong>__iter__</strong><strong>(</strong><strong>)</strong> – Prepares the iterator by resetting environments.</p></li>
<li><p><strong>__next__</strong><strong>(</strong><strong>)</strong> – Iterates over environment states until all episodes are done.</p></li>
<li><p><strong>record_video</strong><strong>(</strong><strong>video_path</strong> – Records a rollout video for each environment.</p></li>
<li><p><strong>max_steps=500</strong> – Records a rollout video for each environment.</p></li>
<li><p><strong>fps=30</strong> – Records a rollout video for each environment.</p></li>
<li><p><strong>seed=None</strong> – Records a rollout video for each environment.</p></li>
<li><p><strong>options=None</strong><strong>)</strong> – Records a rollout video for each environment.</p></li>
<li><p><strong>record_dataset</strong><strong>(</strong><strong>dataset_name</strong> – Collects episodes into a HuggingFace Dataset and saves as Parquet shards.</p></li>
<li><p><strong>episodes=10</strong> – Collects episodes into a HuggingFace Dataset and saves as Parquet shards.</p></li>
<li><p><strong>seed=None</strong> – Collects episodes into a HuggingFace Dataset and saves as Parquet shards.</p></li>
<li><p><strong>options=None</strong><strong>)</strong> – Collects episodes into a HuggingFace Dataset and saves as Parquet shards.</p></li>
<li><p><strong>record_video_from_dataset</strong><strong>(</strong><strong>video_path</strong> – Replays stored dataset episodes and exports them as videos.</p></li>
<li><p><strong>dataset_name</strong> – Replays stored dataset episodes and exports them as videos.</p></li>
<li><p><strong>episode_idx</strong> – Replays stored dataset episodes and exports them as videos.</p></li>
<li><p><strong>max_steps=500</strong> – Replays stored dataset episodes and exports them as videos.</p></li>
<li><p><strong>fps=30</strong> – Replays stored dataset episodes and exports them as videos.</p></li>
<li><p><strong>num_proc=4</strong><strong>)</strong> – Replays stored dataset episodes and exports them as videos.</p></li>
<li><p><strong>evaluate</strong><strong>(</strong><strong>episodes=10</strong> – Evaluates the policy across multiple episodes and computes metrics.</p></li>
<li><p><strong>eval_keys=None</strong> – Evaluates the policy across multiple episodes and computes metrics.</p></li>
<li><p><strong>seed=None</strong> – Evaluates the policy across multiple episodes and computes metrics.</p></li>
<li><p><strong>options=None</strong><strong>)</strong> – Evaluates the policy across multiple episodes and computes metrics.</p></li>
<li><p><strong>Notes</strong></p></li>
<li><p><strong>-----</strong></p></li>
<li><p><strong>tracking.</strong> (<em>- Supports parallelized rollout collection with episode</em>)</p></li>
<li><p><strong>replay.</strong> (<em>- Integrates tightly with HuggingFace Datasets for storage and</em>)</p></li>
<li><p><strong>metrics.</strong> (<em>- Provides success-rate evaluation with optional custom</em>)</p></li>
<li><p><strong>encoding.</strong> (<em>- Video export uses imageio with libx264</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="stable_worldmodel.world.World.action_space">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">action_space</span></span><a class="headerlink" href="#stable_worldmodel.world.World.action_space" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.world.World.close">
<span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/world.html#World.close"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.world.World.close" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.world.World.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">episodes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_keys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/world.html#World.evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.world.World.evaluate" title="Link to this definition">¶</a></dt>
<dd><p>Evaluate the current policy across multiple episodes and compute metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>episodes</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of complete episodes to evaluate.</p></li>
<li><p><strong>eval_keys</strong> (<em>list</em><em>[</em><em>str</em><em>]</em><em>, </em><em>optional</em>) – Additional keys in <code class="docutils literal notranslate"><span class="pre">infos</span></code> to log as episode-wise metrics. Each key will
produce a vector of length <code class="docutils literal notranslate"><span class="pre">episodes</span></code> in the returned metrics dict.</p></li>
<li><p><strong>seed</strong> (<em>int</em><em>, </em><em>optional</em>) – Base seed for the initial reset; per-env continuation seeds derive from this value.</p></li>
<li><p><strong>options</strong> (<em>dict</em><em>, </em><em>optional</em>) – Env reset options.</p></li>
<li><p><strong>Returns</strong></p></li>
<li><p><strong>-------</strong></p></li>
<li><p><strong>dict</strong> – <p>Metrics dictionary with the following entries:
- <code class="docutils literal notranslate"><span class="pre">&quot;success_rate&quot;</span></code> : float</p>
<blockquote>
<div><p>Percentage of successful episodes (terminations) in [0, 100].</p>
</div></blockquote>
<ul>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">&quot;episode_successes&quot;</span></code><span class="classifier">np.ndarray, shape (episodes,)</span></dt><dd><p>Boolean array indicating success (True) or failure (False) per episode.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">&quot;seeds&quot;</span></code><span class="classifier">np.ndarray, shape (episodes,)</span></dt><dd><p>The per-episode seeds used for evaluation.</p>
</dd>
</dl>
</li>
<li><p>Additional arrays for each key in <code class="docutils literal notranslate"><span class="pre">eval_keys</span></code>, each of shape (episodes,).</p></li>
</ul>
</p></li>
<li><p><strong>Notes</strong></p></li>
<li><p><strong>-----</strong></p></li>
<li><p><strong>auto-reset.</strong> (<em>Success is counted using the terminated signal observed prior to an env's</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="stable_worldmodel.world.World.num_envs">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_envs</span></span><a class="headerlink" href="#stable_worldmodel.world.World.num_envs" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="stable_worldmodel.world.World.observation_space">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">observation_space</span></span><a class="headerlink" href="#stable_worldmodel.world.World.observation_space" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.world.World.record_dataset">
<span class="sig-name descname"><span class="pre">record_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">episodes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/world.html#World.record_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.world.World.record_dataset" title="Link to this definition">¶</a></dt>
<dd><p>Collect episodes with the current policy and save them as a HuggingFace Dataset (Parquet shards).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset_name</strong> (<em>str</em>) – Name of the dataset directory under the stable_worldmodel cache dir.</p></li>
<li><p><strong>episodes</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of <em>complete</em> episodes to record (across all envs, total).</p></li>
<li><p><strong>seed</strong> (<em>int</em><em>, </em><em>optional</em>) – Base seed used for the initial reset; subsequent resets for per-env continuation
derive unique seeds from this value.</p></li>
<li><p><strong>options</strong> (<em>dict</em><em>, </em><em>optional</em>) – Env reset options.</p></li>
<li><p><strong>Effects</strong> (<em>Side</em>)</p></li>
<li><p><strong>------------</strong></p></li>
<li><p><strong>files.</strong> (<em>- Creates {cache_dir}/{dataset_name}/data_shard_{NNNNN}.parquet</em>)</p></li>
<li><p><strong>dropped</strong><strong>)</strong><strong>.</strong> (<em>- Appends only complete episodes to the shard</em><em> (</em><em>partial episodes are</em>)</p></li>
<li><p><strong>shards.</strong> (<em>- Re-indexes episode_idx to be contiguous across</em>)</p></li>
<li><p><strong>Schema</strong> (<em>Dataset</em>)</p></li>
<li><p><strong>--------------</strong></p></li>
<li><p><strong>minimum</strong><strong>)</strong> (<em>The resulting dataset includes</em><em> (</em><em>at</em>) – <ul>
<li><p><code class="docutils literal notranslate"><span class="pre">pixels</span></code> : <code class="xref py py-class docutils literal notranslate"><span class="pre">datasets.Image</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">episode_idx</span></code> : <code class="xref py py-class docutils literal notranslate"><span class="pre">datasets.Value(&quot;int32&quot;)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">step_idx</span></code> : <code class="xref py py-class docutils literal notranslate"><span class="pre">datasets.Value(&quot;int32&quot;)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">episode_len</span></code> : <code class="xref py py-class docutils literal notranslate"><span class="pre">datasets.Value(&quot;int32&quot;)</span></code></p></li>
</ul>
</p></li>
<li><p><strong>available</strong> (<em>If</em>) – <ul>
<li><p><code class="docutils literal notranslate"><span class="pre">goal</span></code> : <code class="xref py py-class docutils literal notranslate"><span class="pre">datasets.Image</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">action</span></code> : array-like feature shaped like the env action space</p></li>
<li><p>Per-step scalar/vector fields exposed by the wrapper in <code class="docutils literal notranslate"><span class="pre">infos</span></code></p></li>
</ul>
</p></li>
<li><p><strong>include</strong> (<em>it may also</em>) – <ul>
<li><p><code class="docutils literal notranslate"><span class="pre">goal</span></code> : <code class="xref py py-class docutils literal notranslate"><span class="pre">datasets.Image</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">action</span></code> : array-like feature shaped like the env action space</p></li>
<li><p>Per-step scalar/vector fields exposed by the wrapper in <code class="docutils literal notranslate"><span class="pre">infos</span></code></p></li>
</ul>
</p></li>
<li><p><strong>Notes</strong></p></li>
<li><p><strong>-----</strong></p></li>
<li><p><strong>episodes.</strong> (<em>- The function handles action shifting to ensure alignment with continuing</em>)</p></li>
<li><p><strong>exist.</strong> (<em>- Sharding logic ensures a new shard index is chosen if prior shards</em>)</p></li>
<li><p><strong>shard.</strong> (<em>- Only the first episodes fully completed episodes are persisted for the new</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.world.World.record_video">
<span class="sig-name descname"><span class="pre">record_video</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">video_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/world.html#World.record_video"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.world.World.record_video" title="Link to this definition">¶</a></dt>
<dd><p>Record rollout videos for each environment under the current policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>video_path</strong> (<em>str</em><em> or </em><em>Path</em>) – Directory to which MP4 files will be written; one file per env named <code class="docutils literal notranslate"><span class="pre">env_{i}.mp4</span></code>.</p></li>
<li><p><strong>max_steps</strong> (<em>int</em><em>, </em><em>default=500</em>) – Maximum number of steps to record per environment.</p></li>
<li><p><strong>fps</strong> (<em>int</em><em>, </em><em>default=30</em>) – Frames per second for the output video.</p></li>
<li><p><strong>seed</strong> (<em>int</em><em>, </em><em>optional</em>) – Seed to use for the initial reset prior to recording.</p></li>
<li><p><strong>options</strong> (<em>dict</em><em>, </em><em>optional</em>) – Env reset options.</p></li>
<li><p><strong>Notes</strong></p></li>
<li><p><strong>-----</strong></p></li>
<li><p><strong>&quot;goal&quot;</strong> (<em>- If infos contains</em>) – beneath the observation pixels in the output frames.</p></li>
<li><p><strong>stacked</strong> (<em>the goal image is vertically</em>) – beneath the observation pixels in the output frames.</p></li>
<li><p><strong>``imageio.get_writer</strong><strong>(</strong><strong>...</strong> (<em>- Uses</em>) – </p></li>
<li><p><strong>encoding.</strong> (<em>codec=&quot;libx264&quot;</em><em>)</em><em>`` for MP4</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.world.World.record_video_from_dataset">
<span class="sig-name descname"><span class="pre">record_video_from_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">video_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">episode_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_proc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/world.html#World.record_video_from_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.world.World.record_video_from_dataset" title="Link to this definition">¶</a></dt>
<dd><p>Replay stored dataset episodes and export them as MP4 videos.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>video_path</strong> (<em>str</em><em> or </em><em>Path</em>) – Directory to which MP4 files will be written; one file per requested episode
named <code class="docutils literal notranslate"><span class="pre">episode_{idx}.mp4</span></code>.</p></li>
<li><p><strong>dataset_name</strong> (<em>str</em>) – Name of the dataset directory under the stable_worldmodel cache dir.</p></li>
<li><p><strong>episode_idx</strong> (<em>int</em><em> or </em><em>list</em><em>[</em><em>int</em><em>]</em>) – Episode index or indices to render from the dataset.</p></li>
<li><p><strong>max_steps</strong> (<em>int</em><em>, </em><em>default=500</em>) – Maximum number of steps to render per episode (truncates longer episodes).</p></li>
<li><p><strong>fps</strong> (<em>int</em><em>, </em><em>default=30</em>) – Frames per second for the output video(s).</p></li>
<li><p><strong>num_proc</strong> (<em>int</em><em>, </em><em>default=4</em>) – Degree of parallelism for dataset filtering.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.world.World.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/world.html#World.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.world.World.reset" title="Link to this definition">¶</a></dt>
<dd><p>Reset all environments.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.world.World.set_policy">
<span class="sig-name descname"><span class="pre">set_policy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">policy</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/world.html#World.set_policy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.world.World.set_policy" title="Link to this definition">¶</a></dt>
<dd><p>Attach a policy to the world and provide it the env context.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="stable_worldmodel.world.World.single_action_space">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">single_action_space</span></span><a class="headerlink" href="#stable_worldmodel.world.World.single_action_space" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="stable_worldmodel.world.World.single_observation_space">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">single_observation_space</span></span><a class="headerlink" href="#stable_worldmodel.world.World.single_observation_space" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="stable_worldmodel.world.World.single_variation_space">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">single_variation_space</span></span><a class="headerlink" href="#stable_worldmodel.world.World.single_variation_space" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.world.World.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/world.html#World.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.world.World.step" title="Link to this definition">¶</a></dt>
<dd><p>Advance all environments by one step using the current policy.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="stable_worldmodel.world.World.variation_space">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">variation_space</span></span><a class="headerlink" href="#stable_worldmodel.world.World.variation_space" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-stable_worldmodel.wrappers">
<span id="stable-worldmodel-wrappers-module"></span><h2>stable_worldmodel.wrappers module<a class="headerlink" href="#module-stable_worldmodel.wrappers" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="stable_worldmodel.wrappers.AddPixelsWrapper">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">stable_worldmodel.wrappers.</span></span><span class="sig-name descname"><span class="pre">AddPixelsWrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixels_shape</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(84,</span> <span class="pre">84)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">torchvision_transform</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/wrappers.html#AddPixelsWrapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.wrappers.AddPixelsWrapper" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Wrapper</span></code></p>
<p>Gymnasium wrapper that adds a ‘pixels’ key to the info dict,
containing a rendered and resized image of the environment.
Optionally applies a torchvision transform to the image.
Optionally applies another user-supplied wrapper to the environment.</p>
<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.wrappers.AddPixelsWrapper.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/wrappers.html#AddPixelsWrapper.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.wrappers.AddPixelsWrapper.reset" title="Link to this definition">¶</a></dt>
<dd><p>Uses the <a class="reference internal" href="#stable_worldmodel.wrappers.AddPixelsWrapper.reset" title="stable_worldmodel.wrappers.AddPixelsWrapper.reset"><code class="xref py py-meth docutils literal notranslate"><span class="pre">reset()</span></code></a> of the <code class="xref py py-attr docutils literal notranslate"><span class="pre">env</span></code> that can be overwritten to change the returned data.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.wrappers.AddPixelsWrapper.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/wrappers.html#AddPixelsWrapper.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.wrappers.AddPixelsWrapper.step" title="Link to this definition">¶</a></dt>
<dd><p>Uses the <a class="reference internal" href="#stable_worldmodel.wrappers.AddPixelsWrapper.step" title="stable_worldmodel.wrappers.AddPixelsWrapper.step"><code class="xref py py-meth docutils literal notranslate"><span class="pre">step()</span></code></a> of the <code class="xref py py-attr docutils literal notranslate"><span class="pre">env</span></code> that can be overwritten to change the returned data.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stable_worldmodel.wrappers.EnsureGoalInfoWrapper">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">stable_worldmodel.wrappers.</span></span><span class="sig-name descname"><span class="pre">EnsureGoalInfoWrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_reset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_step</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/wrappers.html#EnsureGoalInfoWrapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.wrappers.EnsureGoalInfoWrapper" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Wrapper</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.wrappers.EnsureGoalInfoWrapper.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/wrappers.html#EnsureGoalInfoWrapper.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.wrappers.EnsureGoalInfoWrapper.reset" title="Link to this definition">¶</a></dt>
<dd><p>Uses the <a class="reference internal" href="#stable_worldmodel.wrappers.EnsureGoalInfoWrapper.reset" title="stable_worldmodel.wrappers.EnsureGoalInfoWrapper.reset"><code class="xref py py-meth docutils literal notranslate"><span class="pre">reset()</span></code></a> of the <code class="xref py py-attr docutils literal notranslate"><span class="pre">env</span></code> that can be overwritten to change the returned data.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.wrappers.EnsureGoalInfoWrapper.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/wrappers.html#EnsureGoalInfoWrapper.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.wrappers.EnsureGoalInfoWrapper.step" title="Link to this definition">¶</a></dt>
<dd><p>Uses the <a class="reference internal" href="#stable_worldmodel.wrappers.EnsureGoalInfoWrapper.step" title="stable_worldmodel.wrappers.EnsureGoalInfoWrapper.step"><code class="xref py py-meth docutils literal notranslate"><span class="pre">step()</span></code></a> of the <code class="xref py py-attr docutils literal notranslate"><span class="pre">env</span></code> that can be overwritten to change the returned data.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stable_worldmodel.wrappers.EnsureImageShape">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">stable_worldmodel.wrappers.</span></span><span class="sig-name descname"><span class="pre">EnsureImageShape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_shape</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/wrappers.html#EnsureImageShape"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.wrappers.EnsureImageShape" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Wrapper</span></code></p>
<p>Gymnasium wrapper to ensure certain keys are present in the info dict.
If a key is missing, it is added with a default value.</p>
<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.wrappers.EnsureImageShape.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/wrappers.html#EnsureImageShape.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.wrappers.EnsureImageShape.reset" title="Link to this definition">¶</a></dt>
<dd><p>Uses the <a class="reference internal" href="#stable_worldmodel.wrappers.EnsureImageShape.reset" title="stable_worldmodel.wrappers.EnsureImageShape.reset"><code class="xref py py-meth docutils literal notranslate"><span class="pre">reset()</span></code></a> of the <code class="xref py py-attr docutils literal notranslate"><span class="pre">env</span></code> that can be overwritten to change the returned data.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.wrappers.EnsureImageShape.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/wrappers.html#EnsureImageShape.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.wrappers.EnsureImageShape.step" title="Link to this definition">¶</a></dt>
<dd><p>Uses the <a class="reference internal" href="#stable_worldmodel.wrappers.EnsureImageShape.step" title="stable_worldmodel.wrappers.EnsureImageShape.step"><code class="xref py py-meth docutils literal notranslate"><span class="pre">step()</span></code></a> of the <code class="xref py py-attr docutils literal notranslate"><span class="pre">env</span></code> that can be overwritten to change the returned data.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stable_worldmodel.wrappers.EnsureInfoKeysWrapper">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">stable_worldmodel.wrappers.</span></span><span class="sig-name descname"><span class="pre">EnsureInfoKeysWrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">required_keys</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/wrappers.html#EnsureInfoKeysWrapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.wrappers.EnsureInfoKeysWrapper" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Wrapper</span></code></p>
<p>Gymnasium wrapper to ensure certain keys are present in the info dict.
If a key is missing, it is added with a default value.</p>
<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.wrappers.EnsureInfoKeysWrapper.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/wrappers.html#EnsureInfoKeysWrapper.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.wrappers.EnsureInfoKeysWrapper.reset" title="Link to this definition">¶</a></dt>
<dd><p>Uses the <a class="reference internal" href="#stable_worldmodel.wrappers.EnsureInfoKeysWrapper.reset" title="stable_worldmodel.wrappers.EnsureInfoKeysWrapper.reset"><code class="xref py py-meth docutils literal notranslate"><span class="pre">reset()</span></code></a> of the <code class="xref py py-attr docutils literal notranslate"><span class="pre">env</span></code> that can be overwritten to change the returned data.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.wrappers.EnsureInfoKeysWrapper.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/wrappers.html#EnsureInfoKeysWrapper.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.wrappers.EnsureInfoKeysWrapper.step" title="Link to this definition">¶</a></dt>
<dd><p>Uses the <a class="reference internal" href="#stable_worldmodel.wrappers.EnsureInfoKeysWrapper.step" title="stable_worldmodel.wrappers.EnsureInfoKeysWrapper.step"><code class="xref py py-meth docutils literal notranslate"><span class="pre">step()</span></code></a> of the <code class="xref py py-attr docutils literal notranslate"><span class="pre">env</span></code> that can be overwritten to change the returned data.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stable_worldmodel.wrappers.EverythingToInfoWrapper">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">stable_worldmodel.wrappers.</span></span><span class="sig-name descname"><span class="pre">EverythingToInfoWrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/wrappers.html#EverythingToInfoWrapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.wrappers.EverythingToInfoWrapper" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Wrapper</span></code></p>
<p>Gymnasium wrapper to ensure the observation is included in the info dict
under a specified key after reset and step.</p>
<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.wrappers.EverythingToInfoWrapper.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/wrappers.html#EverythingToInfoWrapper.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.wrappers.EverythingToInfoWrapper.reset" title="Link to this definition">¶</a></dt>
<dd><p>Uses the <a class="reference internal" href="#stable_worldmodel.wrappers.EverythingToInfoWrapper.reset" title="stable_worldmodel.wrappers.EverythingToInfoWrapper.reset"><code class="xref py py-meth docutils literal notranslate"><span class="pre">reset()</span></code></a> of the <code class="xref py py-attr docutils literal notranslate"><span class="pre">env</span></code> that can be overwritten to change the returned data.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.wrappers.EverythingToInfoWrapper.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/wrappers.html#EverythingToInfoWrapper.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.wrappers.EverythingToInfoWrapper.step" title="Link to this definition">¶</a></dt>
<dd><p>Uses the <a class="reference internal" href="#stable_worldmodel.wrappers.EverythingToInfoWrapper.step" title="stable_worldmodel.wrappers.EverythingToInfoWrapper.step"><code class="xref py py-meth docutils literal notranslate"><span class="pre">step()</span></code></a> of the <code class="xref py py-attr docutils literal notranslate"><span class="pre">env</span></code> that can be overwritten to change the returned data.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stable_worldmodel.wrappers.MegaWrapper">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">stable_worldmodel.wrappers.</span></span><span class="sig-name descname"><span class="pre">MegaWrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_shape</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(84,</span> <span class="pre">84)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixels_transform</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">goal_transform</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">required_keys</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">separate_goal</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/wrappers.html#MegaWrapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.wrappers.MegaWrapper" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Wrapper</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.wrappers.MegaWrapper.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/wrappers.html#MegaWrapper.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.wrappers.MegaWrapper.reset" title="Link to this definition">¶</a></dt>
<dd><p>Uses the <a class="reference internal" href="#stable_worldmodel.wrappers.MegaWrapper.reset" title="stable_worldmodel.wrappers.MegaWrapper.reset"><code class="xref py py-meth docutils literal notranslate"><span class="pre">reset()</span></code></a> of the <code class="xref py py-attr docutils literal notranslate"><span class="pre">env</span></code> that can be overwritten to change the returned data.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.wrappers.MegaWrapper.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/wrappers.html#MegaWrapper.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.wrappers.MegaWrapper.step" title="Link to this definition">¶</a></dt>
<dd><p>Uses the <a class="reference internal" href="#stable_worldmodel.wrappers.MegaWrapper.step" title="stable_worldmodel.wrappers.MegaWrapper.step"><code class="xref py py-meth docutils literal notranslate"><span class="pre">step()</span></code></a> of the <code class="xref py py-attr docutils literal notranslate"><span class="pre">env</span></code> that can be overwritten to change the returned data.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stable_worldmodel.wrappers.ResizeGoalWrapper">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">stable_worldmodel.wrappers.</span></span><span class="sig-name descname"><span class="pre">ResizeGoalWrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixels_shape</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(84,</span> <span class="pre">84)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">torchvision_transform</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/wrappers.html#ResizeGoalWrapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.wrappers.ResizeGoalWrapper" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Wrapper</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.wrappers.ResizeGoalWrapper.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/wrappers.html#ResizeGoalWrapper.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.wrappers.ResizeGoalWrapper.reset" title="Link to this definition">¶</a></dt>
<dd><p>Uses the <a class="reference internal" href="#stable_worldmodel.wrappers.ResizeGoalWrapper.reset" title="stable_worldmodel.wrappers.ResizeGoalWrapper.reset"><code class="xref py py-meth docutils literal notranslate"><span class="pre">reset()</span></code></a> of the <code class="xref py py-attr docutils literal notranslate"><span class="pre">env</span></code> that can be overwritten to change the returned data.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.wrappers.ResizeGoalWrapper.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/wrappers.html#ResizeGoalWrapper.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.wrappers.ResizeGoalWrapper.step" title="Link to this definition">¶</a></dt>
<dd><p>Uses the <a class="reference internal" href="#stable_worldmodel.wrappers.ResizeGoalWrapper.step" title="stable_worldmodel.wrappers.ResizeGoalWrapper.step"><code class="xref py py-meth docutils literal notranslate"><span class="pre">step()</span></code></a> of the <code class="xref py py-attr docutils literal notranslate"><span class="pre">env</span></code> that can be overwritten to change the returned data.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stable_worldmodel.wrappers.VariationWrapper">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">stable_worldmodel.wrappers.</span></span><span class="sig-name descname"><span class="pre">VariationWrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variation_mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Space</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'same'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/wrappers.html#VariationWrapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.wrappers.VariationWrapper" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">VectorWrapper</span></code></p>
<dl class="py property">
<dt class="sig sig-object py" id="stable_worldmodel.wrappers.VariationWrapper.envs">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">envs</span></span><a class="headerlink" href="#stable_worldmodel.wrappers.VariationWrapper.envs" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-stable_worldmodel">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-stable_worldmodel" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="stable_worldmodel.PlanConfig">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">stable_worldmodel.</span></span><span class="sig-name descname"><span class="pre">PlanConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">horizon</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">receding_horizon</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">history_len</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action_block</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">warm_start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/policy.html#PlanConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.PlanConfig" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Configuration for the planning process.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="stable_worldmodel.PlanConfig.action_block">
<span class="sig-name descname"><span class="pre">action_block</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#stable_worldmodel.PlanConfig.action_block" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stable_worldmodel.PlanConfig.history_len">
<span class="sig-name descname"><span class="pre">history_len</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#stable_worldmodel.PlanConfig.history_len" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stable_worldmodel.PlanConfig.horizon">
<span class="sig-name descname"><span class="pre">horizon</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#stable_worldmodel.PlanConfig.horizon" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="stable_worldmodel.PlanConfig.plan_len">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">plan_len</span></span><a class="headerlink" href="#stable_worldmodel.PlanConfig.plan_len" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stable_worldmodel.PlanConfig.receding_horizon">
<span class="sig-name descname"><span class="pre">receding_horizon</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#stable_worldmodel.PlanConfig.receding_horizon" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stable_worldmodel.PlanConfig.warm_start">
<span class="sig-name descname"><span class="pre">warm_start</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#stable_worldmodel.PlanConfig.warm_start" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stable_worldmodel.World">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">stable_worldmodel.</span></span><span class="sig-name descname"><span class="pre">World</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_envs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_shape</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">goal_shape</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">goal_transform</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_transform</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2349867</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_episode_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/world.html#World"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.World" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A high-level environment manager for vectorized gym environments with support for
goal-conditioned tasks, video recording, dataset generation, and evaluation.</p>
<p>The <cite>World</cite> class wraps multiple parallel environments using Gymnasium’s vectorized API and
integrates with custom wrappers (e.g., <cite>MegaWrapper</cite>) to handle image-based observations and goals.
It provides utility methods for recording trajectories, saving datasets in HuggingFace Datasets .parquet format,
evaluating policies, and exporting video rollouts.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env_name</strong> (<em>str</em>) – The name of the Gymnasium environment to instantiate.</p></li>
<li><p><strong>num_envs</strong> (<em>int</em>) – Number of parallel environments to run.</p></li>
<li><p><strong>image_shape</strong> (<em>tuple</em><em>[</em><em>int</em><em>]</em>) – Shape of image observations (C, H, W).</p></li>
<li><p><strong>image_transform</strong> (<em>callable</em><em>, </em><em>optional</em>) – Transformation function applied to image observations.</p></li>
<li><p><strong>goal_shape</strong> (<em>tuple</em><em>[</em><em>int</em><em>]</em><em>, </em><em>optional</em>) – Shape of goal image observations.</p></li>
<li><p><strong>goal_transform</strong> (<em>callable</em><em>, </em><em>optional</em>) – Transformation function applied to goal observations.</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – Random seed for environment initialization and goal sampling.</p></li>
<li><p><strong>max_episode_steps</strong> (<em>int</em><em>, </em><em>default=100</em>) – Maximum number of steps per episode.</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em>) – Additional keyword arguments passed to <cite>gym.make_vec</cite>.</p></li>
<li><p><strong>Attributes</strong></p></li>
<li><p><strong>----------</strong></p></li>
<li><p><strong>envs</strong> (<em>gym.vector.VectorEnv</em>) – Vectorized environments wrapped with <cite>MegaWrapper</cite>.</p></li>
<li><p><strong>goal_envs</strong> (<em>gym.vector.VectorEnv</em>) – Separate vectorized environments for goal sampling.</p></li>
<li><p><strong>seed</strong> – Random seed for reproducibility.</p></li>
<li><p><strong>goal_seed</strong> (<em>int</em>) – Secondary random seed for sampling goals.</p></li>
<li><p><strong>policy</strong> (<em>object</em>) – Policy instance with <cite>get_action</cite> and <cite>set_env</cite> methods.</p></li>
<li><p><strong>Properties</strong></p></li>
<li><p><strong>----------</strong></p></li>
<li><p><strong>num_envs</strong> – Number of environments in the vectorized setup.</p></li>
<li><p><strong>observation_space</strong> (<em>gym.Space</em>) – Observation space of the environments.</p></li>
<li><p><strong>action_space</strong> (<em>gym.Space</em>) – Action space of the environments.</p></li>
<li><p><strong>single_action_space</strong> (<em>gym.Space</em>) – Action space for a single environment.</p></li>
<li><p><strong>single_observation_space</strong> (<em>gym.Space</em>) – Observation space for a single environment.</p></li>
<li><p><strong>Methods</strong></p></li>
<li><p><strong>-------</strong></p></li>
<li><p><strong>close</strong><strong>(</strong><strong>**kwargs</strong><strong>)</strong> – <p>Closes all managed environments.</p>
</p></li>
<li><p><strong>denormalize</strong><strong>(</strong><strong>x</strong><strong>)</strong> – Converts normalized images in [-1, 1] back to [0, 1].</p></li>
<li><p><strong>set_policy</strong><strong>(</strong><strong>policy</strong><strong>)</strong> – Assigns a policy object for interaction.</p></li>
<li><p><strong>reset</strong><strong>(</strong><strong>seed=None</strong> – Resets the environments and returns initial states and infos.</p></li>
<li><p><strong>options=None</strong><strong>)</strong> – Resets the environments and returns initial states and infos.</p></li>
<li><p><strong>step</strong><strong>(</strong><strong>)</strong> – Steps all environments using the current policy’s actions.</p></li>
<li><p><strong>__iter__</strong><strong>(</strong><strong>)</strong> – Prepares the iterator by resetting environments.</p></li>
<li><p><strong>__next__</strong><strong>(</strong><strong>)</strong> – Iterates over environment states until all episodes are done.</p></li>
<li><p><strong>record_video</strong><strong>(</strong><strong>video_path</strong> – Records a rollout video for each environment.</p></li>
<li><p><strong>max_steps=500</strong> – Records a rollout video for each environment.</p></li>
<li><p><strong>fps=30</strong> – Records a rollout video for each environment.</p></li>
<li><p><strong>seed=None</strong> – Records a rollout video for each environment.</p></li>
<li><p><strong>options=None</strong><strong>)</strong> – Records a rollout video for each environment.</p></li>
<li><p><strong>record_dataset</strong><strong>(</strong><strong>dataset_name</strong> – Collects episodes into a HuggingFace Dataset and saves as Parquet shards.</p></li>
<li><p><strong>episodes=10</strong> – Collects episodes into a HuggingFace Dataset and saves as Parquet shards.</p></li>
<li><p><strong>seed=None</strong> – Collects episodes into a HuggingFace Dataset and saves as Parquet shards.</p></li>
<li><p><strong>options=None</strong><strong>)</strong> – Collects episodes into a HuggingFace Dataset and saves as Parquet shards.</p></li>
<li><p><strong>record_video_from_dataset</strong><strong>(</strong><strong>video_path</strong> – Replays stored dataset episodes and exports them as videos.</p></li>
<li><p><strong>dataset_name</strong> – Replays stored dataset episodes and exports them as videos.</p></li>
<li><p><strong>episode_idx</strong> – Replays stored dataset episodes and exports them as videos.</p></li>
<li><p><strong>max_steps=500</strong> – Replays stored dataset episodes and exports them as videos.</p></li>
<li><p><strong>fps=30</strong> – Replays stored dataset episodes and exports them as videos.</p></li>
<li><p><strong>num_proc=4</strong><strong>)</strong> – Replays stored dataset episodes and exports them as videos.</p></li>
<li><p><strong>evaluate</strong><strong>(</strong><strong>episodes=10</strong> – Evaluates the policy across multiple episodes and computes metrics.</p></li>
<li><p><strong>eval_keys=None</strong> – Evaluates the policy across multiple episodes and computes metrics.</p></li>
<li><p><strong>seed=None</strong> – Evaluates the policy across multiple episodes and computes metrics.</p></li>
<li><p><strong>options=None</strong><strong>)</strong> – Evaluates the policy across multiple episodes and computes metrics.</p></li>
<li><p><strong>Notes</strong></p></li>
<li><p><strong>-----</strong></p></li>
<li><p><strong>tracking.</strong> (<em>- Supports parallelized rollout collection with episode</em>)</p></li>
<li><p><strong>replay.</strong> (<em>- Integrates tightly with HuggingFace Datasets for storage and</em>)</p></li>
<li><p><strong>metrics.</strong> (<em>- Provides success-rate evaluation with optional custom</em>)</p></li>
<li><p><strong>encoding.</strong> (<em>- Video export uses imageio with libx264</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="stable_worldmodel.World.action_space">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">action_space</span></span><a class="headerlink" href="#stable_worldmodel.World.action_space" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.World.close">
<span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/world.html#World.close"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.World.close" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.World.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">episodes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_keys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/world.html#World.evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.World.evaluate" title="Link to this definition">¶</a></dt>
<dd><p>Evaluate the current policy across multiple episodes and compute metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>episodes</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of complete episodes to evaluate.</p></li>
<li><p><strong>eval_keys</strong> (<em>list</em><em>[</em><em>str</em><em>]</em><em>, </em><em>optional</em>) – Additional keys in <code class="docutils literal notranslate"><span class="pre">infos</span></code> to log as episode-wise metrics. Each key will
produce a vector of length <code class="docutils literal notranslate"><span class="pre">episodes</span></code> in the returned metrics dict.</p></li>
<li><p><strong>seed</strong> (<em>int</em><em>, </em><em>optional</em>) – Base seed for the initial reset; per-env continuation seeds derive from this value.</p></li>
<li><p><strong>options</strong> (<em>dict</em><em>, </em><em>optional</em>) – Env reset options.</p></li>
<li><p><strong>Returns</strong></p></li>
<li><p><strong>-------</strong></p></li>
<li><p><strong>dict</strong> – <p>Metrics dictionary with the following entries:
- <code class="docutils literal notranslate"><span class="pre">&quot;success_rate&quot;</span></code> : float</p>
<blockquote>
<div><p>Percentage of successful episodes (terminations) in [0, 100].</p>
</div></blockquote>
<ul>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">&quot;episode_successes&quot;</span></code><span class="classifier">np.ndarray, shape (episodes,)</span></dt><dd><p>Boolean array indicating success (True) or failure (False) per episode.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">&quot;seeds&quot;</span></code><span class="classifier">np.ndarray, shape (episodes,)</span></dt><dd><p>The per-episode seeds used for evaluation.</p>
</dd>
</dl>
</li>
<li><p>Additional arrays for each key in <code class="docutils literal notranslate"><span class="pre">eval_keys</span></code>, each of shape (episodes,).</p></li>
</ul>
</p></li>
<li><p><strong>Notes</strong></p></li>
<li><p><strong>-----</strong></p></li>
<li><p><strong>auto-reset.</strong> (<em>Success is counted using the terminated signal observed prior to an env's</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="stable_worldmodel.World.num_envs">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_envs</span></span><a class="headerlink" href="#stable_worldmodel.World.num_envs" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="stable_worldmodel.World.observation_space">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">observation_space</span></span><a class="headerlink" href="#stable_worldmodel.World.observation_space" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.World.record_dataset">
<span class="sig-name descname"><span class="pre">record_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">episodes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/world.html#World.record_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.World.record_dataset" title="Link to this definition">¶</a></dt>
<dd><p>Collect episodes with the current policy and save them as a HuggingFace Dataset (Parquet shards).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset_name</strong> (<em>str</em>) – Name of the dataset directory under the stable_worldmodel cache dir.</p></li>
<li><p><strong>episodes</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of <em>complete</em> episodes to record (across all envs, total).</p></li>
<li><p><strong>seed</strong> (<em>int</em><em>, </em><em>optional</em>) – Base seed used for the initial reset; subsequent resets for per-env continuation
derive unique seeds from this value.</p></li>
<li><p><strong>options</strong> (<em>dict</em><em>, </em><em>optional</em>) – Env reset options.</p></li>
<li><p><strong>Effects</strong> (<em>Side</em>)</p></li>
<li><p><strong>------------</strong></p></li>
<li><p><strong>files.</strong> (<em>- Creates {cache_dir}/{dataset_name}/data_shard_{NNNNN}.parquet</em>)</p></li>
<li><p><strong>dropped</strong><strong>)</strong><strong>.</strong> (<em>- Appends only complete episodes to the shard</em><em> (</em><em>partial episodes are</em>)</p></li>
<li><p><strong>shards.</strong> (<em>- Re-indexes episode_idx to be contiguous across</em>)</p></li>
<li><p><strong>Schema</strong> (<em>Dataset</em>)</p></li>
<li><p><strong>--------------</strong></p></li>
<li><p><strong>minimum</strong><strong>)</strong> (<em>The resulting dataset includes</em><em> (</em><em>at</em>) – <ul>
<li><p><code class="docutils literal notranslate"><span class="pre">pixels</span></code> : <code class="xref py py-class docutils literal notranslate"><span class="pre">datasets.Image</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">episode_idx</span></code> : <code class="xref py py-class docutils literal notranslate"><span class="pre">datasets.Value(&quot;int32&quot;)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">step_idx</span></code> : <code class="xref py py-class docutils literal notranslate"><span class="pre">datasets.Value(&quot;int32&quot;)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">episode_len</span></code> : <code class="xref py py-class docutils literal notranslate"><span class="pre">datasets.Value(&quot;int32&quot;)</span></code></p></li>
</ul>
</p></li>
<li><p><strong>available</strong> (<em>If</em>) – <ul>
<li><p><code class="docutils literal notranslate"><span class="pre">goal</span></code> : <code class="xref py py-class docutils literal notranslate"><span class="pre">datasets.Image</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">action</span></code> : array-like feature shaped like the env action space</p></li>
<li><p>Per-step scalar/vector fields exposed by the wrapper in <code class="docutils literal notranslate"><span class="pre">infos</span></code></p></li>
</ul>
</p></li>
<li><p><strong>include</strong> (<em>it may also</em>) – <ul>
<li><p><code class="docutils literal notranslate"><span class="pre">goal</span></code> : <code class="xref py py-class docutils literal notranslate"><span class="pre">datasets.Image</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">action</span></code> : array-like feature shaped like the env action space</p></li>
<li><p>Per-step scalar/vector fields exposed by the wrapper in <code class="docutils literal notranslate"><span class="pre">infos</span></code></p></li>
</ul>
</p></li>
<li><p><strong>Notes</strong></p></li>
<li><p><strong>-----</strong></p></li>
<li><p><strong>episodes.</strong> (<em>- The function handles action shifting to ensure alignment with continuing</em>)</p></li>
<li><p><strong>exist.</strong> (<em>- Sharding logic ensures a new shard index is chosen if prior shards</em>)</p></li>
<li><p><strong>shard.</strong> (<em>- Only the first episodes fully completed episodes are persisted for the new</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.World.record_video">
<span class="sig-name descname"><span class="pre">record_video</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">video_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/world.html#World.record_video"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.World.record_video" title="Link to this definition">¶</a></dt>
<dd><p>Record rollout videos for each environment under the current policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>video_path</strong> (<em>str</em><em> or </em><em>Path</em>) – Directory to which MP4 files will be written; one file per env named <code class="docutils literal notranslate"><span class="pre">env_{i}.mp4</span></code>.</p></li>
<li><p><strong>max_steps</strong> (<em>int</em><em>, </em><em>default=500</em>) – Maximum number of steps to record per environment.</p></li>
<li><p><strong>fps</strong> (<em>int</em><em>, </em><em>default=30</em>) – Frames per second for the output video.</p></li>
<li><p><strong>seed</strong> (<em>int</em><em>, </em><em>optional</em>) – Seed to use for the initial reset prior to recording.</p></li>
<li><p><strong>options</strong> (<em>dict</em><em>, </em><em>optional</em>) – Env reset options.</p></li>
<li><p><strong>Notes</strong></p></li>
<li><p><strong>-----</strong></p></li>
<li><p><strong>&quot;goal&quot;</strong> (<em>- If infos contains</em>) – beneath the observation pixels in the output frames.</p></li>
<li><p><strong>stacked</strong> (<em>the goal image is vertically</em>) – beneath the observation pixels in the output frames.</p></li>
<li><p><strong>``imageio.get_writer</strong><strong>(</strong><strong>...</strong> (<em>- Uses</em>) – </p></li>
<li><p><strong>encoding.</strong> (<em>codec=&quot;libx264&quot;</em><em>)</em><em>`` for MP4</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.World.record_video_from_dataset">
<span class="sig-name descname"><span class="pre">record_video_from_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">video_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">episode_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_proc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/world.html#World.record_video_from_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.World.record_video_from_dataset" title="Link to this definition">¶</a></dt>
<dd><p>Replay stored dataset episodes and export them as MP4 videos.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>video_path</strong> (<em>str</em><em> or </em><em>Path</em>) – Directory to which MP4 files will be written; one file per requested episode
named <code class="docutils literal notranslate"><span class="pre">episode_{idx}.mp4</span></code>.</p></li>
<li><p><strong>dataset_name</strong> (<em>str</em>) – Name of the dataset directory under the stable_worldmodel cache dir.</p></li>
<li><p><strong>episode_idx</strong> (<em>int</em><em> or </em><em>list</em><em>[</em><em>int</em><em>]</em>) – Episode index or indices to render from the dataset.</p></li>
<li><p><strong>max_steps</strong> (<em>int</em><em>, </em><em>default=500</em>) – Maximum number of steps to render per episode (truncates longer episodes).</p></li>
<li><p><strong>fps</strong> (<em>int</em><em>, </em><em>default=30</em>) – Frames per second for the output video(s).</p></li>
<li><p><strong>num_proc</strong> (<em>int</em><em>, </em><em>default=4</em>) – Degree of parallelism for dataset filtering.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.World.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/world.html#World.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.World.reset" title="Link to this definition">¶</a></dt>
<dd><p>Reset all environments.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.World.set_policy">
<span class="sig-name descname"><span class="pre">set_policy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">policy</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/world.html#World.set_policy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.World.set_policy" title="Link to this definition">¶</a></dt>
<dd><p>Attach a policy to the world and provide it the env context.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="stable_worldmodel.World.single_action_space">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">single_action_space</span></span><a class="headerlink" href="#stable_worldmodel.World.single_action_space" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="stable_worldmodel.World.single_observation_space">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">single_observation_space</span></span><a class="headerlink" href="#stable_worldmodel.World.single_observation_space" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="stable_worldmodel.World.single_variation_space">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">single_variation_space</span></span><a class="headerlink" href="#stable_worldmodel.World.single_variation_space" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_worldmodel.World.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/stable_worldmodel/world.html#World.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.World.step" title="Link to this definition">¶</a></dt>
<dd><p>Advance all environments by one step using the current policy.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="stable_worldmodel.World.variation_space">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">variation_space</span></span><a class="headerlink" href="#stable_worldmodel.World.variation_space" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stable_worldmodel.pretraining">
<span class="sig-prename descclassname"><span class="pre">stable_worldmodel.</span></span><span class="sig-name descname"><span class="pre">pretraining</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">script_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_model_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dump_object</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="reference internal" href="_modules/stable_worldmodel/utils.html#pretraining"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_worldmodel.pretraining" title="Link to this definition">¶</a></dt>
<dd><p>Run a pretraining script as a subprocess with optional command-line arguments.</p>
<p>This function checks if the specified script exists, constructs a command to run it with the provided arguments,
and executes the command in a subprocess.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>script_path</strong> (<em>str</em>) – The path to the pretraining script to be executed.</p></li>
<li><p><strong>dataset_name</strong> (<em>str</em>) – The name of the dataset to be used in pretraining.</p></li>
<li><p><strong>output_model_name</strong> (<em>str</em>) – The name to save the output model.</p></li>
<li><p><strong>dump_object</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to dump the model object after training. Defaults to</p></li>
<li><p><strong>args</strong> (<em>str</em><em>, </em><em>optional</em>) – A string of command-line arguments to pass to the script. Defaults to an empty string.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The return code of the subprocess. A return code of 0 indicates success.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If the specified script does not exist.</p></li>
<li><p><strong>SystemExit</strong> – If the subprocess exits with a non-zero return code.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          
          
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2025
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              <a class="muted-link fa-brands fa-solid fa-discord" href="https://discord.gg/8M6hT39X" aria-label="Discord"></a>
              <a class="muted-link fa-brands fa-solid fa-github" href="https://github.com/randall-lab/stable-worldmodel" aria-label="GitHub"></a>
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">stable_worldmodel package</a><ul>
<li><a class="reference internal" href="#subpackages">Subpackages</a></li>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-stable_worldmodel.cli">stable_worldmodel.cli module</a><ul>
<li><a class="reference internal" href="#stable_worldmodel.cli.common"><code class="docutils literal notranslate"><span class="pre">common()</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.cli.delete"><code class="docutils literal notranslate"><span class="pre">delete()</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.cli.display_dataset_info"><code class="docutils literal notranslate"><span class="pre">display_dataset_info()</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.cli.display_world_info"><code class="docutils literal notranslate"><span class="pre">display_world_info()</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.cli.list_cmd"><code class="docutils literal notranslate"><span class="pre">list_cmd()</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.cli.show"><code class="docutils literal notranslate"><span class="pre">show()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-stable_worldmodel.data">stable_worldmodel.data module</a><ul>
<li><a class="reference internal" href="#stable_worldmodel.data.SpaceInfo"><code class="docutils literal notranslate"><span class="pre">SpaceInfo</span></code></a><ul>
<li><a class="reference internal" href="#stable_worldmodel.data.SpaceInfo.dtype"><code class="docutils literal notranslate"><span class="pre">SpaceInfo.dtype</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.data.SpaceInfo.high"><code class="docutils literal notranslate"><span class="pre">SpaceInfo.high</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.data.SpaceInfo.low"><code class="docutils literal notranslate"><span class="pre">SpaceInfo.low</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.data.SpaceInfo.n"><code class="docutils literal notranslate"><span class="pre">SpaceInfo.n</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.data.SpaceInfo.shape"><code class="docutils literal notranslate"><span class="pre">SpaceInfo.shape</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.data.SpaceInfo.type"><code class="docutils literal notranslate"><span class="pre">SpaceInfo.type</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#stable_worldmodel.data.StepsDataset"><code class="docutils literal notranslate"><span class="pre">StepsDataset</span></code></a><ul>
<li><a class="reference internal" href="#stable_worldmodel.data.StepsDataset.get_episode_slice"><code class="docutils literal notranslate"><span class="pre">StepsDataset.get_episode_slice()</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.data.StepsDataset.infer_img_path_columns"><code class="docutils literal notranslate"><span class="pre">StepsDataset.infer_img_path_columns()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#stable_worldmodel.data.VariationInfo"><code class="docutils literal notranslate"><span class="pre">VariationInfo</span></code></a><ul>
<li><a class="reference internal" href="#stable_worldmodel.data.VariationInfo.has_variation"><code class="docutils literal notranslate"><span class="pre">VariationInfo.has_variation</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.data.VariationInfo.names"><code class="docutils literal notranslate"><span class="pre">VariationInfo.names</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.data.VariationInfo.type"><code class="docutils literal notranslate"><span class="pre">VariationInfo.type</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#stable_worldmodel.data.WorldInfo"><code class="docutils literal notranslate"><span class="pre">WorldInfo</span></code></a><ul>
<li><a class="reference internal" href="#stable_worldmodel.data.WorldInfo.action_space"><code class="docutils literal notranslate"><span class="pre">WorldInfo.action_space</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.data.WorldInfo.config"><code class="docutils literal notranslate"><span class="pre">WorldInfo.config</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.data.WorldInfo.name"><code class="docutils literal notranslate"><span class="pre">WorldInfo.name</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.data.WorldInfo.observation_space"><code class="docutils literal notranslate"><span class="pre">WorldInfo.observation_space</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.data.WorldInfo.variation"><code class="docutils literal notranslate"><span class="pre">WorldInfo.variation</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#stable_worldmodel.data.dataset_info"><code class="docutils literal notranslate"><span class="pre">dataset_info()</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.data.delete_dataset"><code class="docutils literal notranslate"><span class="pre">delete_dataset()</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.data.delete_model"><code class="docutils literal notranslate"><span class="pre">delete_model()</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.data.get_cache_dir"><code class="docutils literal notranslate"><span class="pre">get_cache_dir()</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.data.is_image"><code class="docutils literal notranslate"><span class="pre">is_image()</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.data.list_datasets"><code class="docutils literal notranslate"><span class="pre">list_datasets()</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.data.list_models"><code class="docutils literal notranslate"><span class="pre">list_models()</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.data.list_worlds"><code class="docutils literal notranslate"><span class="pre">list_worlds()</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.data.world_info"><code class="docutils literal notranslate"><span class="pre">world_info()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-stable_worldmodel.policy">stable_worldmodel.policy module</a><ul>
<li><a class="reference internal" href="#stable_worldmodel.policy.AutoCostModel"><code class="docutils literal notranslate"><span class="pre">AutoCostModel()</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.policy.BasePolicy"><code class="docutils literal notranslate"><span class="pre">BasePolicy</span></code></a><ul>
<li><a class="reference internal" href="#stable_worldmodel.policy.BasePolicy.get_action"><code class="docutils literal notranslate"><span class="pre">BasePolicy.get_action()</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.policy.BasePolicy.set_env"><code class="docutils literal notranslate"><span class="pre">BasePolicy.set_env()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#stable_worldmodel.policy.ExpertPolicy"><code class="docutils literal notranslate"><span class="pre">ExpertPolicy</span></code></a><ul>
<li><a class="reference internal" href="#stable_worldmodel.policy.ExpertPolicy.get_action"><code class="docutils literal notranslate"><span class="pre">ExpertPolicy.get_action()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#stable_worldmodel.policy.PlanConfig"><code class="docutils literal notranslate"><span class="pre">PlanConfig</span></code></a><ul>
<li><a class="reference internal" href="#stable_worldmodel.policy.PlanConfig.action_block"><code class="docutils literal notranslate"><span class="pre">PlanConfig.action_block</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.policy.PlanConfig.history_len"><code class="docutils literal notranslate"><span class="pre">PlanConfig.history_len</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.policy.PlanConfig.horizon"><code class="docutils literal notranslate"><span class="pre">PlanConfig.horizon</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.policy.PlanConfig.plan_len"><code class="docutils literal notranslate"><span class="pre">PlanConfig.plan_len</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.policy.PlanConfig.receding_horizon"><code class="docutils literal notranslate"><span class="pre">PlanConfig.receding_horizon</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.policy.PlanConfig.warm_start"><code class="docutils literal notranslate"><span class="pre">PlanConfig.warm_start</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#stable_worldmodel.policy.RandomPolicy"><code class="docutils literal notranslate"><span class="pre">RandomPolicy</span></code></a><ul>
<li><a class="reference internal" href="#stable_worldmodel.policy.RandomPolicy.get_action"><code class="docutils literal notranslate"><span class="pre">RandomPolicy.get_action()</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.policy.RandomPolicy.set_seed"><code class="docutils literal notranslate"><span class="pre">RandomPolicy.set_seed()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#stable_worldmodel.policy.WorldModelPolicy"><code class="docutils literal notranslate"><span class="pre">WorldModelPolicy</span></code></a><ul>
<li><a class="reference internal" href="#stable_worldmodel.policy.WorldModelPolicy.flatten_receding_horizon"><code class="docutils literal notranslate"><span class="pre">WorldModelPolicy.flatten_receding_horizon</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.policy.WorldModelPolicy.get_action"><code class="docutils literal notranslate"><span class="pre">WorldModelPolicy.get_action()</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.policy.WorldModelPolicy.set_env"><code class="docutils literal notranslate"><span class="pre">WorldModelPolicy.set_env()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-stable_worldmodel.spaces">stable_worldmodel.spaces module</a><ul>
<li><a class="reference internal" href="#stable_worldmodel.spaces.Box"><code class="docutils literal notranslate"><span class="pre">Box</span></code></a><ul>
<li><a class="reference internal" href="#stable_worldmodel.spaces.Box.__init__"><code class="docutils literal notranslate"><span class="pre">Box.__init__()</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.spaces.Box.check"><code class="docutils literal notranslate"><span class="pre">Box.check()</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.spaces.Box.contains"><code class="docutils literal notranslate"><span class="pre">Box.contains()</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.spaces.Box.init_value"><code class="docutils literal notranslate"><span class="pre">Box.init_value</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.spaces.Box.reset"><code class="docutils literal notranslate"><span class="pre">Box.reset()</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.spaces.Box.sample"><code class="docutils literal notranslate"><span class="pre">Box.sample()</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.spaces.Box.value"><code class="docutils literal notranslate"><span class="pre">Box.value</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#stable_worldmodel.spaces.Dict"><code class="docutils literal notranslate"><span class="pre">Dict</span></code></a><ul>
<li><a class="reference internal" href="#stable_worldmodel.spaces.Dict.__init__"><code class="docutils literal notranslate"><span class="pre">Dict.__init__()</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.spaces.Dict.check"><code class="docutils literal notranslate"><span class="pre">Dict.check()</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.spaces.Dict.contains"><code class="docutils literal notranslate"><span class="pre">Dict.contains()</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.spaces.Dict.init_value"><code class="docutils literal notranslate"><span class="pre">Dict.init_value</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.spaces.Dict.names"><code class="docutils literal notranslate"><span class="pre">Dict.names()</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.spaces.Dict.reset"><code class="docutils literal notranslate"><span class="pre">Dict.reset()</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.spaces.Dict.sample"><code class="docutils literal notranslate"><span class="pre">Dict.sample()</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.spaces.Dict.sampling_order"><code class="docutils literal notranslate"><span class="pre">Dict.sampling_order</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.spaces.Dict.update"><code class="docutils literal notranslate"><span class="pre">Dict.update()</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.spaces.Dict.value"><code class="docutils literal notranslate"><span class="pre">Dict.value</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#stable_worldmodel.spaces.Discrete"><code class="docutils literal notranslate"><span class="pre">Discrete</span></code></a><ul>
<li><a class="reference internal" href="#stable_worldmodel.spaces.Discrete.__init__"><code class="docutils literal notranslate"><span class="pre">Discrete.__init__()</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.spaces.Discrete.check"><code class="docutils literal notranslate"><span class="pre">Discrete.check()</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.spaces.Discrete.contains"><code class="docutils literal notranslate"><span class="pre">Discrete.contains()</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.spaces.Discrete.init_value"><code class="docutils literal notranslate"><span class="pre">Discrete.init_value</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.spaces.Discrete.reset"><code class="docutils literal notranslate"><span class="pre">Discrete.reset()</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.spaces.Discrete.sample"><code class="docutils literal notranslate"><span class="pre">Discrete.sample()</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.spaces.Discrete.value"><code class="docutils literal notranslate"><span class="pre">Discrete.value</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#stable_worldmodel.spaces.MultiDiscrete"><code class="docutils literal notranslate"><span class="pre">MultiDiscrete</span></code></a><ul>
<li><a class="reference internal" href="#stable_worldmodel.spaces.MultiDiscrete.__init__"><code class="docutils literal notranslate"><span class="pre">MultiDiscrete.__init__()</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.spaces.MultiDiscrete.check"><code class="docutils literal notranslate"><span class="pre">MultiDiscrete.check()</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.spaces.MultiDiscrete.contains"><code class="docutils literal notranslate"><span class="pre">MultiDiscrete.contains()</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.spaces.MultiDiscrete.init_value"><code class="docutils literal notranslate"><span class="pre">MultiDiscrete.init_value</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.spaces.MultiDiscrete.reset"><code class="docutils literal notranslate"><span class="pre">MultiDiscrete.reset()</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.spaces.MultiDiscrete.sample"><code class="docutils literal notranslate"><span class="pre">MultiDiscrete.sample()</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.spaces.MultiDiscrete.value"><code class="docutils literal notranslate"><span class="pre">MultiDiscrete.value</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#stable_worldmodel.spaces.RGBBox"><code class="docutils literal notranslate"><span class="pre">RGBBox</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-stable_worldmodel.utils">stable_worldmodel.utils module</a><ul>
<li><a class="reference internal" href="#stable_worldmodel.utils.flatten_dict"><code class="docutils literal notranslate"><span class="pre">flatten_dict()</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.utils.get_in"><code class="docutils literal notranslate"><span class="pre">get_in()</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.utils.pretraining"><code class="docutils literal notranslate"><span class="pre">pretraining()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-stable_worldmodel.world">stable_worldmodel.world module</a><ul>
<li><a class="reference internal" href="#stable_worldmodel.world.World"><code class="docutils literal notranslate"><span class="pre">World</span></code></a><ul>
<li><a class="reference internal" href="#stable_worldmodel.world.World.action_space"><code class="docutils literal notranslate"><span class="pre">World.action_space</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.world.World.close"><code class="docutils literal notranslate"><span class="pre">World.close()</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.world.World.evaluate"><code class="docutils literal notranslate"><span class="pre">World.evaluate()</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.world.World.num_envs"><code class="docutils literal notranslate"><span class="pre">World.num_envs</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.world.World.observation_space"><code class="docutils literal notranslate"><span class="pre">World.observation_space</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.world.World.record_dataset"><code class="docutils literal notranslate"><span class="pre">World.record_dataset()</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.world.World.record_video"><code class="docutils literal notranslate"><span class="pre">World.record_video()</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.world.World.record_video_from_dataset"><code class="docutils literal notranslate"><span class="pre">World.record_video_from_dataset()</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.world.World.reset"><code class="docutils literal notranslate"><span class="pre">World.reset()</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.world.World.set_policy"><code class="docutils literal notranslate"><span class="pre">World.set_policy()</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.world.World.single_action_space"><code class="docutils literal notranslate"><span class="pre">World.single_action_space</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.world.World.single_observation_space"><code class="docutils literal notranslate"><span class="pre">World.single_observation_space</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.world.World.single_variation_space"><code class="docutils literal notranslate"><span class="pre">World.single_variation_space</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.world.World.step"><code class="docutils literal notranslate"><span class="pre">World.step()</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.world.World.variation_space"><code class="docutils literal notranslate"><span class="pre">World.variation_space</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-stable_worldmodel.wrappers">stable_worldmodel.wrappers module</a><ul>
<li><a class="reference internal" href="#stable_worldmodel.wrappers.AddPixelsWrapper"><code class="docutils literal notranslate"><span class="pre">AddPixelsWrapper</span></code></a><ul>
<li><a class="reference internal" href="#stable_worldmodel.wrappers.AddPixelsWrapper.reset"><code class="docutils literal notranslate"><span class="pre">AddPixelsWrapper.reset()</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.wrappers.AddPixelsWrapper.step"><code class="docutils literal notranslate"><span class="pre">AddPixelsWrapper.step()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#stable_worldmodel.wrappers.EnsureGoalInfoWrapper"><code class="docutils literal notranslate"><span class="pre">EnsureGoalInfoWrapper</span></code></a><ul>
<li><a class="reference internal" href="#stable_worldmodel.wrappers.EnsureGoalInfoWrapper.reset"><code class="docutils literal notranslate"><span class="pre">EnsureGoalInfoWrapper.reset()</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.wrappers.EnsureGoalInfoWrapper.step"><code class="docutils literal notranslate"><span class="pre">EnsureGoalInfoWrapper.step()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#stable_worldmodel.wrappers.EnsureImageShape"><code class="docutils literal notranslate"><span class="pre">EnsureImageShape</span></code></a><ul>
<li><a class="reference internal" href="#stable_worldmodel.wrappers.EnsureImageShape.reset"><code class="docutils literal notranslate"><span class="pre">EnsureImageShape.reset()</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.wrappers.EnsureImageShape.step"><code class="docutils literal notranslate"><span class="pre">EnsureImageShape.step()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#stable_worldmodel.wrappers.EnsureInfoKeysWrapper"><code class="docutils literal notranslate"><span class="pre">EnsureInfoKeysWrapper</span></code></a><ul>
<li><a class="reference internal" href="#stable_worldmodel.wrappers.EnsureInfoKeysWrapper.reset"><code class="docutils literal notranslate"><span class="pre">EnsureInfoKeysWrapper.reset()</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.wrappers.EnsureInfoKeysWrapper.step"><code class="docutils literal notranslate"><span class="pre">EnsureInfoKeysWrapper.step()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#stable_worldmodel.wrappers.EverythingToInfoWrapper"><code class="docutils literal notranslate"><span class="pre">EverythingToInfoWrapper</span></code></a><ul>
<li><a class="reference internal" href="#stable_worldmodel.wrappers.EverythingToInfoWrapper.reset"><code class="docutils literal notranslate"><span class="pre">EverythingToInfoWrapper.reset()</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.wrappers.EverythingToInfoWrapper.step"><code class="docutils literal notranslate"><span class="pre">EverythingToInfoWrapper.step()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#stable_worldmodel.wrappers.MegaWrapper"><code class="docutils literal notranslate"><span class="pre">MegaWrapper</span></code></a><ul>
<li><a class="reference internal" href="#stable_worldmodel.wrappers.MegaWrapper.reset"><code class="docutils literal notranslate"><span class="pre">MegaWrapper.reset()</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.wrappers.MegaWrapper.step"><code class="docutils literal notranslate"><span class="pre">MegaWrapper.step()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#stable_worldmodel.wrappers.ResizeGoalWrapper"><code class="docutils literal notranslate"><span class="pre">ResizeGoalWrapper</span></code></a><ul>
<li><a class="reference internal" href="#stable_worldmodel.wrappers.ResizeGoalWrapper.reset"><code class="docutils literal notranslate"><span class="pre">ResizeGoalWrapper.reset()</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.wrappers.ResizeGoalWrapper.step"><code class="docutils literal notranslate"><span class="pre">ResizeGoalWrapper.step()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#stable_worldmodel.wrappers.VariationWrapper"><code class="docutils literal notranslate"><span class="pre">VariationWrapper</span></code></a><ul>
<li><a class="reference internal" href="#stable_worldmodel.wrappers.VariationWrapper.envs"><code class="docutils literal notranslate"><span class="pre">VariationWrapper.envs</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-stable_worldmodel">Module contents</a><ul>
<li><a class="reference internal" href="#stable_worldmodel.PlanConfig"><code class="docutils literal notranslate"><span class="pre">PlanConfig</span></code></a><ul>
<li><a class="reference internal" href="#stable_worldmodel.PlanConfig.action_block"><code class="docutils literal notranslate"><span class="pre">PlanConfig.action_block</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.PlanConfig.history_len"><code class="docutils literal notranslate"><span class="pre">PlanConfig.history_len</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.PlanConfig.horizon"><code class="docutils literal notranslate"><span class="pre">PlanConfig.horizon</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.PlanConfig.plan_len"><code class="docutils literal notranslate"><span class="pre">PlanConfig.plan_len</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.PlanConfig.receding_horizon"><code class="docutils literal notranslate"><span class="pre">PlanConfig.receding_horizon</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.PlanConfig.warm_start"><code class="docutils literal notranslate"><span class="pre">PlanConfig.warm_start</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#stable_worldmodel.World"><code class="docutils literal notranslate"><span class="pre">World</span></code></a><ul>
<li><a class="reference internal" href="#stable_worldmodel.World.action_space"><code class="docutils literal notranslate"><span class="pre">World.action_space</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.World.close"><code class="docutils literal notranslate"><span class="pre">World.close()</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.World.evaluate"><code class="docutils literal notranslate"><span class="pre">World.evaluate()</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.World.num_envs"><code class="docutils literal notranslate"><span class="pre">World.num_envs</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.World.observation_space"><code class="docutils literal notranslate"><span class="pre">World.observation_space</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.World.record_dataset"><code class="docutils literal notranslate"><span class="pre">World.record_dataset()</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.World.record_video"><code class="docutils literal notranslate"><span class="pre">World.record_video()</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.World.record_video_from_dataset"><code class="docutils literal notranslate"><span class="pre">World.record_video_from_dataset()</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.World.reset"><code class="docutils literal notranslate"><span class="pre">World.reset()</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.World.set_policy"><code class="docutils literal notranslate"><span class="pre">World.set_policy()</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.World.single_action_space"><code class="docutils literal notranslate"><span class="pre">World.single_action_space</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.World.single_observation_space"><code class="docutils literal notranslate"><span class="pre">World.single_observation_space</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.World.single_variation_space"><code class="docutils literal notranslate"><span class="pre">World.single_variation_space</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.World.step"><code class="docutils literal notranslate"><span class="pre">World.step()</span></code></a></li>
<li><a class="reference internal" href="#stable_worldmodel.World.variation_space"><code class="docutils literal notranslate"><span class="pre">World.variation_space</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#stable_worldmodel.pretraining"><code class="docutils literal notranslate"><span class="pre">pretraining()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="_static/documentation_options.js?v=a5192d03"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/furo.js?v=46bd48cc"></script>
    </body>
</html>